import{j as e,r as n,p as $,d as k,H,q as I,I as U,e as G,F as Q}from"./Footer-5a793555.js";import{F as W}from"./Filters-5c1cd9b5.js";import{s as q,Q as s,S as M,f as A,T as _,M as z,u as V,a as J,b as f,L as K}from"./Spinner-21315384.js";function X({expenseI:t,setExpense:r,setOption:x,setOpenModal:p,setHelper:h,setMustLoad:y,setMustAnimate:l,setIsDeleted:u}){const g=()=>{q("¿Quieres eliminar esta razón?",()=>{u(!0),l(!1);const d=s(e.jsx(M,{message:`Eliminando a ${t.reason}`}),{autoClose:3e3,hideProgressBar:!0});A("DELETE","/expenses/destroy",{id:t.id}).then(o=>{if(y(!1),o.errors)return u(!1),s.update(d,{render:e.jsx(e.Fragment,{children:e.jsx(_,{data:o.errors})}),type:s.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});if(o.message)return u(!1),s.update(d,{render:e.jsx(e.Fragment,{children:o.message}),type:s.TYPE.INFO,autoClose:3e3,hideProgressBar:!1});s.update(d,{render:`Razón ${t.reason} ha sido eliminada.`,type:s.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),h(j=>j+1)}).catch(o=>{s.update(d,{render:"Hay problemas de conexión",type:s.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})})})};return e.jsxs("div",{className:"flex flex-wrap flex-col justify-between lg:flex-row p-2 md:p-3 md:mx-5",children:[e.jsxs("p",{className:"uppercase tracking-wide text-sm text-indigo-500 font-semibold text-center md:text-start lg:w-9/12",children:[e.jsx("strong",{children:"Razón de egreso:"})," ",t.reason]}),e.jsxs("div",{className:"my-3 flex justify-center items-center gap-2",children:[e.jsx("button",{className:"bg-vetsky rounded-md py-1 px-4 font-semibold hover:bg-gray-400",onClick:()=>{x("Actualizar"),p(!0),r(t)},children:"Editar"}),e.jsx("button",{className:"bg-vetbrown rounded-md py-1 px-4 text-white font-semibold hover:bg-gray-500",onClick:g,children:"Eliminar"})]})]})}const b={id:"MODIFY_ID",reason:"MODIFY_REASON"};function Z(t,r){switch(r.type){case b.id:return{...t,id:r.payload};case b.reason:return{...t,reason:r.payload};default:return t}}function ee({expense:t,option:r,open:x,setOpen:p,setMustLoad:h,setHelper:y}){const l={method:r==="Crear"?"POST":"PUT",url:r!=="Actualizar"?"/expenses/store":"/expenses/update",sucessMessage:r==="Crear"?"Razón agregada":"Razón actualizada",loadingMessage:r!=="Actualizar"?"Agregando razón":"Actualizando razón"},[u,g]=n.useReducer(Z,t),[d,o]=n.useState(!1),j=i=>{i.preventDefault(),o(!0);const m=s(e.jsx(M,{message:l.loadingMessage}),{autoClose:1e4,hideProgressBar:!0});A(l.method,l.url,u).then(a=>{if(a.errors)return s.update(m,{render:e.jsx(e.Fragment,{children:e.jsx(_,{data:a.errors})}),type:s.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});s.update(m,{render:l.sucessMessage,type:s.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),h(!1),y(E=>E+1),p(!1)}).catch(a=>{console.log(a),s.update(m,{render:"Hay problemas de conexión",type:s.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})}).finally(()=>o(!1))};return n.useEffect(()=>{for(const i in b){const m=b[i],a=t.hasOwnProperty(i)?t[i]:"";g({type:m,payload:a})}},[t]),e.jsxs(e.Fragment,{children:[e.jsx(z,{option:r,open:x,setOpen:p,isLoading:d,handleSubmit:j,icon:$,text:"Razón",children:e.jsxs("div",{className:"relative border border-gray-600 rounded w-full col-span-full order-1",children:[e.jsx("textarea",{className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",rows:"4",value:u.reason,onChange:i=>{g({type:b.reason,payload:i.target.value})}}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Razón de egreso"})]})}),e.jsx(z.ToastifyModal,{})]})}function ae(){var F,T,N;const t={id:"",reason:""},r=[{name:"Razón",value:"reason"}],[x,p]=n.useState(1),[h,y]=n.useState(12),[l,u]=n.useState("reason"),[g,d]=n.useState(""),{debounceValue:o}=V(g,500),[j,i]=n.useState(0),m=`/expenses/list?page=${x}&limit=${h}&filter=${l}&inputFilter=${o}`,{data:a,loading:E}=J(m,[x,h,j]),[B,w]=n.useState("Crear"),[D,S]=n.useState(!1),[O,R]=n.useState(t),[Y,v]=n.useState(!0),[L,C]=n.useState(!0);return n.useEffect(()=>{E||(v(!0),C(!0),p(1),i(c=>c+1))},[o]),e.jsxs(e.Fragment,{children:[e.jsx(H,{icon:I,message:"Gestión de egresos",name:"egreso",setOpen:S,setOption:w,setData:R,initialState:t}),e.jsx(W,{children:r.map((c,P)=>e.jsx("button",{className:`${l===c.value?"bg-vetgreen-200 text-white":"bg-vetgreen-100 hover:bg-vetgreen-200 hover:text-white"} cursor-pointer p-2 rounded-md flex-grow`,onClick:()=>{u(c.value),d("")},children:c.name},P))}),e.jsxs(f,{children:[e.jsx(f.Search,{inputFilter:g,setInputFilter:d,filter:l,filters:r,renderMoreFilters:!1}),e.jsx(f.FilterBar,{hide:!o,data:[{tag:(F=r.find(c=>c.value===l))==null?void 0:F.name,input:o,handleClick:()=>d("")}]}),e.jsx(f.CardContainer,{children:E&Y?e.jsx(K,{message:"Cargando razones de egreso"}):((T=a.data)==null?void 0:T.length)===0?e.jsx("div",{className:"bg-white p-4 border rounded shadow-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-lg",children:[e.jsx(U,{icon:G,css:"mr-3"}),"No hay datos disponibles."]})}):e.jsx(e.Fragment,{children:(N=a==null?void 0:a.data)==null?void 0:N.map((c,P)=>e.jsx(f.CardContainer.Card,{mustAnimate:L,setMustAnimate:C,width:"w-full",children:e.jsx(X,{expenseI:c,setExpense:R,setOption:w,setOpenModal:S,setHelper:i,setMustLoad:v,setMustAnimate:C})},`${c.id}-${P}`))})}),e.jsx(f.Pagination,{pageQuantity:a.current_page*a.per_page,quantity:a.total,setMustLoad:v,setLimit:y,setPage:p,nextPage:a.next_page_url,prevPage:a.prev_page_url,page:a.current_page,lastPage:a.last_page,setMustAnimate:C})]}),e.jsx(ee,{expense:O,option:B,open:D,setOpen:S,setMustLoad:v,setHelper:i}),e.jsx(Q,{})]})}const te=k.createRoot(document.getElementById("expense"));te.render(e.jsx(ae,{}));
