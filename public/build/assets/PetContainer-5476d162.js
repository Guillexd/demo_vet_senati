import{r as t,j as e,h as ie,I as K,i as pe,k as ge,d as xe,H as he,e as fe,F as be}from"./Footer-e7201637.js";import{F as ye}from"./Filters-1c1117c5.js";import{c as ve,d as je,s as Ne,Q as u,S as V,f as de,T as ce,u as Z,a as ee,M as le,b as P,L as Se}from"./Spinner-5b2387ff.js";import{R as oe}from"./ReactSelect-ba1b28da.js";import{S as ne}from"./Selector-f99f2359.js";import{C as Ce,i as _e}from"./initialStateCustomer-2f824edc.js";import{B as Ee,i as we}from"./BreedModal-68fcfab8.js";import{I as Fe}from"./ImageModal-120ec1cb.js";function Me({petI:a,setPet:l,setOption:F,setOpenModal:m,setHelper:M,setMustLoad:D,setMustAnimate:x,setOpenImage:T,setImage:C,setIsDeleted:b}){var N,h,y,v,_,i;const[f,d]=t.useState(!1),c=()=>{Ne("¿Quieres eliminar esta mascota?",()=>{b(!0),x(!1);const S=u(e.jsx(V,{message:`Eliminando a ${a.name}`}),{autoClose:3e3,hideProgressBar:!0});de("DELETE","/pets/destroy",{id:a.id}).then(o=>{if(D(!1),o.errors)return b(!1),u.update(S,{render:e.jsx(e.Fragment,{children:e.jsx(ce,{data:o.errors})}),type:u.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});if(o.message)return b(!1),u.update(S,{render:e.jsx(e.Fragment,{children:o.message}),type:u.TYPE.INFO,autoClose:3e3,hideProgressBar:!1});u.update(S,{render:`Mascota ${a.name} ha sido eliminado.`,type:u.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),M(B=>B+1)}).catch(o=>{u.update(S,{render:"Hay problemas de conexión",type:u.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})})},"Se eliminarán los datos asociados a esta mascota como el historial de las mismas.")};return e.jsxs(e.Fragment,{children:[e.jsx("img",{className:"w-full h-60 object-cover",src:a.pet_image_url||"/image/mascota.webp",alt:a.name,onClick:()=>{C({url:a.pet_image_url||"/image/mascota.webp",label:a.name}),T(!0)}}),e.jsxs("div",{className:"px-8 pt-5 flex flex-col justify-between flex-1",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"uppercase tracking-wide text-sm text-indigo-500 font-semibold",children:["Nombre: ",a.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Edad: ",a.age]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Raza: ",(N=a.breed)==null?void 0:N.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Sexo: ",a.sex]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["C/E: ",a.ce]}),e.jsxs("p",{className:"mt-2 text-gray-700",children:["Dueño: ",(h=a.customer)==null?void 0:h.name," - ",(v=(y=a.customer)==null?void 0:y.identity_document)==null?void 0:v.abbreviation,": ",(_=a.customer)==null?void 0:_.document_number]}),e.jsxs("p",{className:"text-gray-700",children:["Fecha: ",ve(a.created_at)]}),e.jsx("p",{className:"text-gray-900",children:je(a.created_at)}),((i=a.observations)==null?void 0:i.length)>50?e.jsxs("div",{children:[e.jsx("button",{className:"bg-indigo-500 text-white font-semibold px-3 py-1 rounded-lg",onClick:()=>d(!0),children:"Observaciones"}),e.jsxs("article",{className:`${f?"-translate-y-0":"translate-y-full"} ease-in duration-150 absolute flex top-0 left-0 w-full h-full bg-vetgreen-200 text-black font-medium rounded-lg`,children:[e.jsx("button",{className:"fixed bg-red-900 text-white font-semibold px-3 py-1 rounded-lg top-1 right-0 me-5 mt-1 animate-bounce",onClick:()=>d(!1),children:"Cerrar"}),e.jsx("p",{className:"overflow-auto p-3 pt-8",children:a.observations})]})]}):e.jsxs("p",{className:"text-gray-700 font-semibold",children:[" ",e.jsx("strong",{children:"Observaciones:"})," ",a.observations||"---"]})]}),e.jsxs("div",{className:"my-3 flex gap-2",children:[e.jsx("button",{className:"bg-vetsky rounded-md py-1 px-4 font-semibold hover:bg-gray-400",onClick:()=>{F("Actualizar"),m(!0),l(a)},children:"Editar"}),e.jsx("button",{className:"bg-vetbrown rounded-md py-1 px-4 text-white font-semibold hover:bg-gray-500",onClick:c,children:"Eliminar"})]})]})]})}const n={id:"MODIFY_ID",name:"MODIFY_NAME",age:"MODIFY_AGE",customer_id:"MODIFY_CUSTOMER_ID",breed_id:"MODIFY_BREED_ID",sex:"MODIFY_SEX",ce:"MODIFY_CE",pet_image:"MODIFY_PET_IMAGE",observations:"MODIFY_OBSERVATIONS"};function Be(a,l){switch(l.type){case n.id:return{...a,id:l.payload||""};case n.name:return{...a,name:l.payload||""};case n.age:return{...a,age:l.payload||""};case n.customer_id:return{...a,customer_id:l.payload||""};case n.breed_id:return{...a,breed_id:l.payload||""};case n.sex:return{...a,sex:l.payload||""};case n.ce:return{...a,ce:l.payload||""};case n.pet_image:return{...a,pet_image:l.payload||""};case n.observations:return{...a,observations:l.payload||""};default:return a}}function Oe({pet:a,option:l,open:F,setOpen:m,setMustLoad:M,setHelper:D}){var p,ae,te,se;const x={method:"POST",url:l!=="Actualizar"?"/pets/store":"/pets/update",sucessMessage:l==="Crear"?"Mascota agregada":"Mascota actualizada",loadingMessage:l!=="Actualizar"?"Agregando mascota":"Actualizando mascota"},[T,C]=t.useState(!1),[b,f]=t.useState(!1),[d,c]=t.useReducer(Be,a),[N,h]=t.useState(!1),[y,v]=t.useState("name"),[_,i]=t.useState(""),[S,o]=t.useState(1),[B,Y]=t.useState(!1),[A,G]=t.useState(!1),{debounceValue:O}=Z(_,400),{data:I,loading:R}=ee(`/customers/list?filter=${y}&inputFilter=${O}`,[S],A),[L,j]=t.useState(""),[q,E]=t.useState(1),[Q,k]=t.useState(!1),[W,X]=t.useState(!1),{debounceValue:H}=Z(L,400),{data:$,loading:z}=ee(`/breeds/list?filter=name&inputFilter=${H}`,[q],W),r=s=>{s.preventDefault(),h(!0);const g=u(e.jsx(V,{message:x.loadingMessage}),{autoClose:3e4,hideProgressBar:!0});de(x.method,x.url,d,!0).then(w=>{if(w.errors)return u.update(g,{render:e.jsx(e.Fragment,{children:e.jsx(ce,{data:w.errors})}),type:u.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});u.update(g,{render:x.sucessMessage,type:u.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),M(!1),D(U=>U+1),m(!1)}).catch(w=>{console.log(w),u.update(g,{render:"Hay problemas de conexión",type:u.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})}).finally(()=>h(!1))};return t.useEffect(()=>{!R&&B&&o(s=>s+1)},[O]),t.useEffect(()=>{!z&&Q&&E(s=>s+1)},[H]),t.useEffect(()=>{var g,w,U,re;(g=a.customer)!=null&&g.name?i((w=a.customer)==null?void 0:w.name):i(""),(U=a.breed)!=null&&U.name?j((re=a.breed)==null?void 0:re.name):j("");const s=document.getElementById("pet_image");s.value="";for(const J in n){const ue=n[J],me=a.hasOwnProperty(J)?a[J]:"";c({type:ue,payload:me})}},[a]),e.jsxs(e.Fragment,{children:[e.jsxs(le,{option:l,open:F,setOpen:m,isLoading:N,handleSubmit:r,icon:ie,text:"Mascota",children:[e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:d.name,onChange:s=>{c({type:n.name,payload:s.target.value})},required:!0,autoFocus:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Nombre"})]}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:d.age,onChange:s=>{c({type:n.age,payload:s.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Edad"})]}),e.jsxs("div",{className:"relative w-full col-span-full grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsx(oe,{setMustSearch:Y,filters:[{tag:"Nombre del dueño",value:"name"},{tag:"Número de documento",value:"document_number"}],filter:y,setFilter:v,input:_,setInput:i,label:"Dueño",setHelperSearch:G,setHelper:o,css:"w-full col-span-full order-1 pe-10",listStyle:"w-full max-h-72",children:R?e.jsx("div",{className:"w-full sm:w-1/2 mx-auto py-4",children:e.jsx(V,{message:"Buscando a los clientes ..."})}):((p=I.data)==null?void 0:p.length)===0?e.jsx("h3",{className:"cursor-pointer py-4 text-center",children:"No hay clientes con este dato ..."}):e.jsx("ul",{className:"px-5 py-2",children:(ae=I.data)==null?void 0:ae.map((s,g)=>e.jsx("li",{className:"cursor-pointer hover:bg-slate-600 rounded p-2",onClick:()=>{c({type:n.customer_id,payload:s.id}),Y(!1),i(s.name)},children:`${s.name} - ${s.identity_document?`${s.identity_document.abbreviation}: ${s.document_number}`:"--"}`},g))})}),e.jsx("button",{type:"button",className:"order-1 absolute bottom-1 right-12 bg-gray-100 rounded-full px-2 py-1 z-10 hover:bg-gray-300",onClick:()=>C(!0),children:e.jsx(K,{icon:pe})})]}),e.jsx("div",{className:"absolute",children:e.jsx(Ce,{customer:{..._e},option:"Crear",open:T,setOpen:C,actions:!1,mustBeToast:!1,focus:!1})}),e.jsxs("div",{className:"relative w-full col-span-full grid grid-cols-1 sm:grid-cols-2 gap-6 order-1",children:[e.jsx(oe,{setMustSearch:k,input:L,setInput:j,label:"Raza",setHelperSearch:X,setHelper:E,listStyle:"w-full max-h-72",children:z?e.jsx("div",{className:"w-full sm:w-1/2 mx-auto py-4",children:e.jsx(V,{message:"Buscando a las razas ..."})}):((te=$.data)==null?void 0:te.length)===0?e.jsx("h3",{className:"cursor-pointer py-4 text-center",children:"No hay razas con este dato ..."}):e.jsx("ul",{className:"px-5 py-2",children:(se=$.data)==null?void 0:se.map((s,g)=>e.jsx("li",{className:"cursor-pointer hover:bg-slate-600 rounded p-2",onClick:()=>{c({type:n.breed_id,payload:s.id}),k(!1),j(s.name)},children:s.name},g))})}),e.jsx("button",{type:"button",className:"order-1 absolute bottom-1 right-12 top-1 bg-gray-100 rounded-full px-2 py-1 z-10 hover:bg-gray-300",onClick:()=>f(!0),children:e.jsx(K,{icon:ge,size:"22px"})})]}),e.jsx("div",{className:"absolute",children:e.jsx(Ee,{breed:{...we},option:"Crear",open:b,setOpen:f,actions:!1,mustBeToast:!1,focus:!1})}),e.jsx(ne,{message:"Sexo",filters:[{tag:"Macho",value:"Macho"},{tag:"Hembra",value:"Hembra"}],filter:d.sex,setFilter:s=>c({type:n.sex,payload:s})}),e.jsx(ne,{message:"C/E",filters:[{tag:d.sex=="Hembra"?"Esterilizada":"Castrado",value:d.sex=="Hembra"?"Esterilizada":"Castrado"},{tag:"Entero",value:"Entero"}],filter:d.ce,setFilter:s=>c({type:n.ce,payload:s})}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full col-span-full order-1",children:[e.jsx("input",{type:"file",className:"hidden",id:"pet_image",accept:"image/*",onChange:s=>{const g=s.target.files&&s.target.files[0];c({type:n.pet_image,payload:g})}}),e.jsx("label",{htmlFor:"pet_image",className:"cursor-pointer block w-full py-2 text-center text-gray-600 bg-transparent rounded transition duration-200 ease-in-out hover:bg-gray-300",children:"--- Seleccionar foto (opcional) ---"})]}),d.pet_image&&e.jsx("img",{src:URL.createObjectURL(d.pet_image),alt:"mascota",className:"order-1 w-3/5 col-span-full mx-auto rounded-lg"}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full col-span-full order-1",children:[e.jsx("textarea",{className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",rows:"4",value:d.observations,onChange:s=>{c({type:n.observations,payload:s.target.value})}}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Observaciones (opcional)"})]})]}),e.jsx(le.ToastifyModal,{})]})}function Pe(){var H,$,z;const a={id:"",name:"",age:"",customer_id:"",breed_id:"",sex:"Macho",ce:"Entero",pet_image:null,observations:"No hay observaciones."},l=[{name:"Nombre",value:"name"},{name:"Nombre del dueño",value:"customer_id"},{name:"Número de documento del dueño",value:"document_number"},{name:"Raza",value:"breed_id"}],[F,m]=t.useState(1),[M,D]=t.useState(12),[x,T]=t.useState("name"),[C,b]=t.useState(""),[f,d]=t.useState(""),[c,N]=t.useState(""),[h,y]=t.useState(""),{debounceValue:v}=Z(C,500),[_,i]=t.useState(0),S=`/pets/list?page=${F}&limit=${M}&filter=${x}&inputFilter=${v}&sex=${f}&startDate=${c}&finishDate=${h}`,{data:o,loading:B}=ee(S,[F,M,_]),[Y,A]=t.useState("Crear"),[G,O]=t.useState(!1),[I,R]=t.useState(a),[L,j]=t.useState(!0),[q,E]=t.useState(!0),[Q,k]=t.useState(!1),[W,X]=t.useState({url:"",label:""});return t.useEffect(()=>{B||(j(!0),E(!0),m(1),i(r=>r+1))},[v]),e.jsxs(e.Fragment,{children:[e.jsx(he,{icon:ie,message:"Gestión de mascotas",name:"mascota",setOpen:O,setOption:A,setData:R,initialState:a}),e.jsx(ye,{children:e.jsx("div",{className:"w-full flex justify-between flex-wrap sm:flex-nowrap gap-y-1",children:l.map((r,p)=>e.jsx("button",{className:`${x===r.value?"bg-vetgreen-200 text-white":"bg-vetgreen-100 hover:bg-vetgreen-200 hover:text-white"} cursor-pointer py-2 md:mx-2 mx-1 rounded-xl sm:rounded-full flex-grow`,onClick:()=>{T(r.value),b("")},children:r.name},p))})}),e.jsxs(P,{children:[e.jsxs(P.Search,{inputFilter:C,setInputFilter:b,handleReset:()=>{d(""),N(""),y(""),m(1),i(r=>r+1)},filter:x,filters:l,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Sexo de la mascota"}),e.jsxs("select",{className:"p-2 rounded-xl bg-gray-300 w-full",value:f,onChange:r=>{d(r.target.value),m(1),i(p=>p+1)},children:[e.jsx("option",{value:"",children:"Ambos"}),e.jsx("option",{value:"Macho",children:"Macho"}),e.jsx("option",{value:"Hembra",children:"Hembra"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de inicio"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:c,onChange:r=>{N(r.target.value),m(1),i(p=>p+1)}})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de finalización"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:h,onChange:r=>{y(r.target.value),m(1),i(p=>p+1)}})]})]}),e.jsx(P.FilterBar,{hide:!v&&!f&&!c&&!h,data:[{tag:(H=l.find(r=>r.value===x))==null?void 0:H.name,input:v,handleClick:()=>b("")},{tag:"Sexo de la mascota",input:f.length>0?f:null,handleClick:()=>{d(""),m(1),i(r=>r+1)}},{tag:"Fecha de inicio",input:c.length>0?c:null,handleClick:()=>{N(""),m(1),i(r=>r+1)}},{tag:"Fecha de finalización",input:h.length>0?h:null,handleClick:()=>{y(""),m(1),i(r=>r+1)}}]}),e.jsx(P.CardContainer,{children:B&L?e.jsx(Se,{message:"Cargando mascotas"}):(($=o.data)==null?void 0:$.length)===0?e.jsx("div",{className:"bg-white p-4 border rounded shadow-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-lg",children:[e.jsx(K,{icon:fe,css:"mr-3"}),"No hay datos disponibles."]})}):e.jsx(e.Fragment,{children:(z=o==null?void 0:o.data)==null?void 0:z.map((r,p)=>e.jsx(P.CardContainer.Card,{mustAnimate:q,setMustAnimate:E,children:e.jsx(Me,{petI:r,setPet:R,setOption:A,setOpenModal:O,setHelper:i,setMustLoad:j,setMustAnimate:E,setOpenImage:k,setImage:X})},`${r.id}-${p}`))})}),e.jsx(P.Pagination,{pageQuantity:o.current_page*o.per_page,quantity:o.total,setMustLoad:j,setLimit:D,setPage:m,nextPage:o.next_page_url,prevPage:o.prev_page_url,page:o.current_page,lastPage:o.last_page,setMustAnimate:E})]}),e.jsx(Fe,{image:W,open:Q,setOpen:k}),e.jsx(Oe,{pet:I,option:Y,open:G,setOpen:O,setMustLoad:j,setHelper:i}),e.jsx(be,{})]})}const De=xe.createRoot(document.getElementById("pet"));De.render(e.jsx(Pe,{}));
