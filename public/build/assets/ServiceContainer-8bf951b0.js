import{j as e,r,i as A,c as q,H as G,I as Q,d as W,F as V}from"./Footer-3e7d975a.js";import{F as J}from"./Filters-0ab54ce7.js";import{e as K,s as X,Q as s,S as B,f as O,T as Y,M as k,u as Z,a as ee,b as S,L as te}from"./Spinner-98bddcb3.js";function ae({serviceI:t,setService:n,setOption:j,setOpenModal:l,setHelper:b,setMustLoad:C,setMustAnimate:u,setIsDeleted:m}){const x=()=>{X("¿Quieres eliminar este servicio?",()=>{m(!0),u(!1);const p=s(e.jsx(B,{message:`Eliminando a ${t.name}`}),{autoClose:3e3,hideProgressBar:!0});O("DELETE","/services/destroy",{id:t.id}).then(o=>{if(C(!1),o.errors)return m(!1),s.update(p,{render:e.jsx(e.Fragment,{children:e.jsx(Y,{data:o.errors})}),type:s.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});if(o.message)return m(!1),s.update(p,{render:e.jsx(e.Fragment,{children:o.message}),type:s.TYPE.INFO,autoClose:3e3,hideProgressBar:!1});s.update(p,{render:`Servicio ${t.name} ha sido eliminado.`,type:s.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),b(f=>f+1)}).catch(o=>{s.update(p,{render:"Hay problemas de conexión",type:s.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})})})};return e.jsxs("div",{className:"flex flex-wrap flex-col md:flex-row p-2 md:p-0 md:mx-5",children:[e.jsxs("p",{className:"uppercase tracking-wide text-sm text-indigo-500 font-semibold text-center md:text-start md:w-5/12 m-auto",children:["Nombre: ",t.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold text-center m-auto",children:["Código: ",K("S",t.id)]}),e.jsxs("p",{className:"text-gray-900 font-semibold text-center m-auto",children:["Precio: S/",t.price]}),e.jsxs("div",{className:"my-3 flex justify-center items-center gap-2",children:[e.jsx("button",{className:"bg-vetsky rounded-md py-1 px-4 font-semibold hover:bg-gray-400",onClick:()=>{j("Actualizar"),l(!0),n(t)},children:"Editar"}),e.jsx("button",{className:"bg-vetbrown rounded-md py-1 px-4 text-white font-semibold hover:bg-gray-500",onClick:x,children:"Eliminar"})]})]})}const v={id:"MODIFY_ID",name:"MODIFY_NAME",price:"MODIFY_PRICE"};function re(t,n){switch(n.type){case v.id:return{...t,id:n.payload};case v.name:return{...t,name:n.payload};case v.price:return{...t,price:n.payload};default:return t}}function se({service:t,option:n,open:j,setOpen:l,setMustLoad:b,setHelper:C}){const u={method:n==="Crear"?"POST":"PUT",url:n!=="Actualizar"?"/services/store":"/services/update",sucessMessage:n==="Crear"?"Servicio agregado":"Servicio actualizado",loadingMessage:n!=="Actualizar"?"Agregando servicio":"Actualizando servicio"},[m,x]=r.useReducer(re,t),[p,o]=r.useState(!1),f=i=>{i.preventDefault(),o(!0);const g=s(e.jsx(B,{message:u.loadingMessage}),{autoClose:1e4,hideProgressBar:!0});O(u.method,u.url,m).then(d=>{if(d.errors)return s.update(g,{render:e.jsx(e.Fragment,{children:e.jsx(Y,{data:d.errors})}),type:s.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});s.update(g,{render:u.sucessMessage,type:s.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),b(!1),C(P=>P+1),l(!1)}).catch(d=>{console.log(d),s.update(g,{render:"Hay problemas de conexión",type:s.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})}).finally(()=>o(!1))};return r.useEffect(()=>{for(const i in v){const g=v[i],d=t.hasOwnProperty(i)?t[i]:"";x({type:g,payload:d})}},[t]),e.jsxs(e.Fragment,{children:[e.jsxs(k,{option:n,open:j,setOpen:l,isLoading:p,handleSubmit:f,icon:A,text:"Servicio",children:[e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:m.name,onChange:i=>{x({type:v.name,payload:i.target.value})},required:!0,autoFocus:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Nombre"})]}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:m.price,onChange:i=>{x({type:v.price,payload:i.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Precio"})]})]}),e.jsx(k.ToastifyModal,{})]})}function ne(){var M,R,_;const t={id:"",name:"",price:""},n=[{name:"Nombre",value:"name"},{name:"Código",value:"id"}],[j,l]=r.useState(1),[b,C]=r.useState(12),[u,m]=r.useState("name"),[x,p]=r.useState(""),[o,f]=r.useState(""),[i,g]=r.useState(""),{debounceValue:d}=Z(x,500),[P,h]=r.useState(0),$=`/services/list?page=${j}&limit=${b}&filter=${u}&inputFilter=${d}&startDate=${o}&finishDate=${i}`,{data:c,loading:w}=ee($,[j,b,P]),[L,T]=r.useState("Crear"),[z,F]=r.useState(!1),[I,D]=r.useState(t),[H,N]=r.useState(!0),[U,E]=r.useState(!0);return r.useEffect(()=>{w||(N(!0),E(!0),l(1),h(a=>a+1))},[d]),e.jsxs(e.Fragment,{children:[e.jsx(G,{icon:A,message:"Gestión de servicios",name:"servicio",setOpen:F,setOption:T,setData:D,initialState:t}),e.jsx(J,{children:n.map((a,y)=>e.jsx("button",{className:`${u===a.value?"bg-vetgreen-200 text-white":"bg-vetgreen-100 hover:bg-vetgreen-200 hover:text-white"} cursor-pointer py-2 md:mx-2 mx-1 rounded-full flex-grow`,onClick:()=>{m(a.value),p("")},children:a.name},y))}),e.jsxs(S,{children:[e.jsxs(S.Search,{inputFilter:x,setInputFilter:p,handleReset:()=>{f(""),g(""),l(1),h(a=>a+1)},children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de inicio"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:o,onChange:a=>{f(a.target.value),l(1),h(y=>y+1)}})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de finalización"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:i,onChange:a=>{g(a.target.value),l(1),h(y=>y+1)}})]})]}),e.jsx(S.FilterBar,{hide:!d&&!o&&!i,data:[{tag:(M=n.find(a=>a.value===u))==null?void 0:M.name,input:d,handleClick:()=>p("")},{tag:"Fecha de inicio",input:o.length>0?o:null,handleClick:()=>{f(""),l(1),h(a=>a+1)}},{tag:"Fecha de finalización",input:i.length>0?i:null,handleClick:()=>{g(""),l(1),h(a=>a+1)}}]}),e.jsx(S.CardContainer,{children:w&H?e.jsx(te,{message:"Cargando servicios"}):((R=c.data)==null?void 0:R.length)===0?e.jsx("div",{className:"bg-white p-4 border rounded shadow-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-lg",children:[e.jsx(Q,{icon:W,css:"mr-3"}),"No hay datos disponibles."]})}):e.jsx(e.Fragment,{children:(_=c==null?void 0:c.data)==null?void 0:_.map((a,y)=>e.jsx(S.CardContainer.Card,{mustAnimate:U,setMustAnimate:E,width:"w-full",children:e.jsx(ae,{serviceI:a,setService:D,setOption:T,setOpenModal:F,setHelper:h,setMustLoad:N,setMustAnimate:E})},`${a.id}-${y}`))})}),e.jsx(S.Pagination,{pageQuantity:c.current_page*c.per_page,quantity:c.total,setMustLoad:N,setLimit:C,setPage:l,nextPage:c.next_page_url,prevPage:c.prev_page_url,page:c.current_page,lastPage:c.last_page,setMustAnimate:E})]}),e.jsx(se,{service:I,option:L,open:z,setOpen:F,setMustLoad:N,setHelper:h}),e.jsx(V,{})]})}const ie=q.createRoot(document.getElementById("service"));ie.render(e.jsx(ne,{}));
