import{r as s,j as e,m as I,c as Z,H as ee,I as te,d as ae,F as re}from"./Footer-b67b93bd.js";import{F as ne}from"./Filters-bb7c5f68.js";import{e as se,k as le,g as ie,d as oe,s as ce,Q as c,S as $,f as A,T as B,M as L,u as de,a as ue,i as pe,j as me,b as C,L as xe}from"./Spinner-360b4a09.js";import{I as ge}from"./ImageModal-94313bc1.js";function he({productI:t,setProduct:n,setOption:j,setOpenModal:p,setHelper:N,setMustLoad:w,setMustAnimate:h,setOpenImage:l,setImage:u,setIsDeleted:v}){var d;const[y,b]=s.useState(!1),a=()=>{ce("¿Quieres eliminar este producto?",()=>{v(!0),h(!1);const o=c(e.jsx($,{message:`Eliminando a ${t.name}`}),{autoClose:3e3,hideProgressBar:!0});A("DELETE","/products/destroy",{id:t.id}).then(m=>{if(w(!1),m.errors)return v(!1),c.update(o,{render:e.jsx(e.Fragment,{children:e.jsx(B,{data:m.errors})}),type:c.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});if(m.message)return v(!1),c.update(o,{render:e.jsx(e.Fragment,{children:m.message}),type:c.TYPE.INFO,autoClose:3e3,hideProgressBar:!1});c.update(o,{render:`Producto ${t.name} ha sido eliminado.`,type:c.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),N(_=>_+1)}).catch(m=>{c.update(o,{render:"Hay problemas de conexión",type:c.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})})})};return e.jsxs(e.Fragment,{children:[e.jsx("img",{className:"w-full h-96 object-contain",src:t.product_image_url||"/image/juguete.webp",alt:t.name,onClick:()=>{u({url:t.product_image_url||"/image/juguete.webp",label:t.name}),l(!0)}}),e.jsxs("div",{className:"px-8 pt-5 flex flex-col justify-between flex-1",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"uppercase tracking-wide text-sm text-indigo-500 font-semibold",children:["Nombre: ",t.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Precio: S/",t.price]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Stock: ",t.stock," u."]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Código: ",se("P",t.id)]}),t.serie&&e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Serie: ",t.serie]}),e.jsxs("p",{className:"mt-2 text-gray-700",children:["Precio de compra: S/",t.purchase_price]}),e.jsxs("p",{className:"text-gray-700",children:["Utilidad: S/",t.utility]}),e.jsxs("p",{className:"text-gray-900",children:["Fecha de vencimiento: ",t.due_date?le(t.due_date):"---"]}),e.jsxs("p",{className:"text-gray-700",children:["Fecha: ",ie(t.created_at)]}),e.jsx("p",{className:"text-gray-900",children:oe(t.created_at)}),((d=t.description)==null?void 0:d.length)>50?e.jsxs("div",{children:[e.jsx("button",{className:"bg-indigo-500 text-white font-semibold px-3 py-1 rounded-lg",onClick:()=>b(!0),children:"Descripción"}),e.jsxs("article",{className:`${y?"-translate-y-0":"translate-y-full"} ease-in duration-150 absolute flex top-0 left-0 w-full h-full bg-vetgreen-200 text-black font-medium rounded-lg`,children:[e.jsx("button",{className:"fixed bg-red-900 text-white font-semibold px-3 py-1 rounded-lg top-1 right-0 me-5 mt-1 animate-bounce",onClick:()=>b(!1),children:"Cerrar"}),e.jsx("p",{className:"overflow-auto p-3 pt-8",children:t.description})]})]}):e.jsxs("p",{className:"text-gray-700 font-semibold",children:[" ",e.jsx("strong",{children:"Descripción:"})," ",t.description||"---"]})]}),e.jsxs("div",{className:"my-3 flex gap-2",children:[e.jsx("button",{className:"bg-vetsky rounded-md py-1 px-4 font-semibold hover:bg-gray-400",onClick:()=>{j("Actualizar"),p(!0),n(t)},children:"Editar"}),e.jsx("button",{className:"bg-vetbrown rounded-md py-1 px-4 text-white font-semibold hover:bg-gray-500",onClick:a,children:"Eliminar"})]})]})]})}const i={id:"MODIFY_ID",name:"MODIFY_NAME",price:"MODIFY_PRICE",purchase_price:"MODIFY_PURCHASE_PRICE",stock:"MODIFY_STOCK",utility:"MODIFY_UTILITY",serie:"MODIFY_SERIE",product_image:"MODIFY_PRODUCT_IMAGE",description:"MODIFY_DESCRIPTION",due_date:"MODIFY_DUE_DATE"};function ye(t,n){switch(n.type){case i.id:return{...t,id:n.payload||""};case i.name:return{...t,name:n.payload||""};case i.price:return{...t,price:n.payload||""};case i.purchase_price:return{...t,purchase_price:n.payload||""};case i.stock:return{...t,stock:n.payload||""};case i.utility:return{...t,utility:n.payload||""};case i.serie:return{...t,serie:n.payload||""};case i.product_image:return{...t,product_image:n.payload||""};case i.description:return{...t,description:n.payload||""};case i.due_date:return{...t,due_date:n.payload||""};default:return t}}function fe({product:t,option:n,open:j,setOpen:p,setMustLoad:N,setHelper:w}){const h={method:"POST",url:n!=="Actualizar"?"/products/store":"/products/update",sucessMessage:n==="Crear"?"Producto agregado":"Producto actualizado",loadingMessage:n!=="Actualizar"?"Agregando producto":"Actualizando producto"},[l,u]=s.useReducer(ye,t),[v,y]=s.useState(!1),b=a=>{a.preventDefault(),y(!0);const d=c(e.jsx($,{message:h.loadingMessage}),{autoClose:3e4,hideProgressBar:!0});A(h.method,h.url,l,!0).then(o=>{if(o.errors)return c.update(d,{render:e.jsx(e.Fragment,{children:e.jsx(B,{data:o.errors})}),type:c.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});if(o.message)return c.update(d,{render:e.jsx(e.Fragment,{children:o.message}),type:c.TYPE.INFO,autoClose:3e3,hideProgressBar:!1});c.update(d,{render:h.sucessMessage,type:c.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),N(!1),w(m=>m+1),p(!1)}).catch(o=>{console.log(o),c.update(d,{render:"Hay problemas de conexión",type:c.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})}).finally(()=>y(!1))};return s.useEffect(()=>{const a=document.getElementById("product_image");a.value="";for(const d in i){const o=i[d],m=t.hasOwnProperty(d)?t[d]:"";u({type:o,payload:m})}},[t]),s.useEffect(()=>{Number(l.price)&&Number(l.purchase_price)&&u({type:"MODIFY_UTILITY",payload:(parseFloat(l.price)-parseFloat(l.purchase_price)).toFixed(2)})},[l.price,l.purchase_price]),e.jsxs(e.Fragment,{children:[e.jsxs(L,{option:n,open:j,setOpen:p,isLoading:v,handleSubmit:b,icon:I,text:"Producto",children:[e.jsxs("div",{className:"relative border rounded w-full col-span-1 order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-neutral-200 placeholder:text-neutral-200 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:l.name,onChange:a=>{u({type:i.name,payload:a.target.value})},required:!0,autoFocus:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-neutral-200 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Nombre"})]}),e.jsxs("div",{className:"relative border rounded w-full col-span-1 order-1",children:[e.jsx("input",{type:"number",min:0,className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-neutral-200 placeholder:text-neutral-200 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:l.stock,onChange:a=>{u({type:i.stock,payload:a.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-neutral-200 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Stock"})]}),e.jsxs("div",{className:"w-full col-span-full order-1 grid grid-cols-1 sm:grid-cols-3 gap-6 sm:gap-x-6",children:[e.jsxs("div",{className:"relative border rounded w-full order-1",children:[e.jsx("input",{type:"number",step:"any",min:0,className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-neutral-200 placeholder:text-neutral-200 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:l.price,onChange:a=>{u({type:i.price,payload:a.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-neutral-200 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Precio"})]}),e.jsxs("div",{className:"relative border rounded w-full order-1",children:[e.jsx("input",{type:"number",step:"any",min:0,className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-neutral-200 placeholder:text-neutral-200 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:l.purchase_price,onChange:a=>{u({type:i.purchase_price,payload:a.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-neutral-200 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Precio de compra"})]}),e.jsxs("div",{className:"relative border rounded w-full order-1",children:[e.jsx("input",{type:"number",step:"any",min:0,className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-neutral-200 placeholder:text-neutral-200 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:l.utility,onChange:a=>{u({type:i.utility,payload:a.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-neutral-200 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Utilidad"})]})]}),e.jsxs("div",{className:"relative border rounded w-full col-span-full order-1",children:[e.jsx("input",{type:"file",className:"hidden",id:"product_image",accept:"image/*",onChange:a=>{const d=a.target.files&&a.target.files[0];u({type:i.product_image,payload:d})}}),e.jsx("label",{htmlFor:"product_image",className:"cursor-pointer block w-full py-2 text-center text-white bg-gray-800 rounded transition duration-200 ease-in-out hover:bg-gray-600",children:"--- Seleccionar foto (opcional) ---"})]}),l.product_image&&e.jsx("img",{src:URL.createObjectURL(l.product_image),alt:"mascota",className:"order-1 w-3/5 col-span-full mx-auto rounded-lg"}),e.jsxs("div",{className:"relative border rounded w-full order-1 col-span-full sm:col-span-1",children:[e.jsx("input",{type:"datetime-local",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-neutral-200 placeholder:text-neutral-200 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:l.due_date,onChange:a=>{u({type:i.due_date,payload:a.target.value})}}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-neutral-200 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Fecha de vencimiento (opcional)"})]}),e.jsxs("div",{className:"relative border rounded w-full col-span-full sm:col-span-1 order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-neutral-200 placeholder:text-neutral-200 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:l.serie,onChange:a=>{u({type:i.serie,payload:a.target.value})}}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-neutral-200 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Serie (opcional)"})]}),e.jsxs("div",{className:"relative border rounded w-full col-span-full order-1",children:[e.jsx("textarea",{className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-neutral-200 placeholder:text-neutral-200 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",rows:"4",value:l.description,onChange:a=>{u({type:i.description,payload:a.target.value})}}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-neutral-200 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Descripción (opcional)"})]})]}),e.jsx(L.ToastifyModal,{})]})}function ve(){var M,R,Y;const t={id:"",name:"",price:"",purchase_price:"",stock:"",utility:"",serie:"",product_image:null,description:"No hay descripción.",due_date:""},n=[{name:"Nombre",value:"name"},{name:"Código",value:"id"},{name:"Serie",value:"serie"}],[j,p]=s.useState(1),[N,w]=s.useState(12),[h,l]=s.useState("name"),[u,v]=s.useState(""),[y,b]=s.useState(""),[a,d]=s.useState(""),[o,m]=s.useState(""),{debounceValue:_}=de(u,500),[U,f]=s.useState(0),H=`/products/list?page=${j}&limit=${N}&filter=${h}&inputFilter=${_}&dueDate=${y}&startDate=${a}&finishDate=${o}`,{data:g,loading:D}=ue(H,[j,N,U]),[z,k]=s.useState("Crear"),[q,E]=s.useState(!1),[G,T]=s.useState(t),[Q,S]=s.useState(!0),[W,F]=s.useState(!0),[K,O]=s.useState(!1),[V,J]=s.useState({url:"",label:""});return s.useEffect(()=>{D||(S(!0),F(!0),p(1),f(r=>r+1))},[_]),s.useEffect(()=>{setTimeout(()=>{pe("/products/by_due_date").then(r=>{if(r.count==0)return;const x=document.createElement("p");x.classList.add("text-center"),x.innerText=`!Tienes ${r.count} producto(s) por vencer en el rango de 30 días!`;const P=document.createElement("div");P.classList.add("text-start"),P.classList.add("ms-5"),r.products.forEach(X=>{P.innerHTML+=`
            <li class='font-bold'>${X.name}</li>
          `}),me(x,P)})},1e3)},[]),e.jsxs(e.Fragment,{children:[e.jsx(ee,{icon:I,message:"Gestión de productos",name:"producto",setOpen:E,setOption:k,setData:T,initialState:t}),e.jsx(ne,{children:n.map((r,x)=>e.jsx("button",{className:`${h===r.value?"bg-vetgreen-200 text-white":"bg-vetgreen-100 hover:bg-vetgreen-200 hover:text-white"} cursor-pointer py-2 md:mx-2 mx-1 rounded-full flex-grow`,onClick:()=>{l(r.value),v("")},children:r.name},x))}),e.jsxs(C,{children:[e.jsxs(C.Search,{inputFilter:u,setInputFilter:v,handleReset:()=>{b(""),d(""),m(""),p(1),f(r=>r+1)},children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de vencimiento"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:y,onChange:r=>{b(r.target.value),p(1),f(x=>x+1)}})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha inicio"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:a,onChange:r=>{d(r.target.value),p(1),f(x=>x+1)}})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de finalización"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:o,onChange:r=>{m(r.target.value),p(1),f(x=>x+1)}})]})]}),e.jsx(C.FilterBar,{hide:!_&&!a&&!o&&!y,data:[{tag:(M=n.find(r=>r.value===h))==null?void 0:M.name,input:_,handleClick:()=>v("")},{tag:"Fecha de inicio",input:a.length>0?a:null,handleClick:()=>{d(""),p(1),f(r=>r+1)}},{tag:"Fecha de finalización",input:o.length>0?o:null,handleClick:()=>{m(""),p(1),f(r=>r+1)}},{tag:"Fecha de vencimiento",input:y.length>0?y:null,handleClick:()=>{b(""),p(1),f(r=>r+1)}}]}),e.jsx(C.CardContainer,{children:D&Q?e.jsx(xe,{message:"Cargando productos"}):((R=g.data)==null?void 0:R.length)===0?e.jsx("div",{className:"bg-white p-4 border rounded shadow-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-lg",children:[e.jsx(te,{icon:ae,css:"mr-3"}),"No hay datos disponibles."]})}):e.jsx(e.Fragment,{children:(Y=g==null?void 0:g.data)==null?void 0:Y.map((r,x)=>e.jsx(C.CardContainer.Card,{mustAnimate:W,setMustAnimate:F,children:e.jsx(he,{productI:r,setProduct:T,setOption:k,setOpenModal:E,setHelper:f,setMustLoad:S,setMustAnimate:F,setOpenImage:O,setImage:J})},`${r.id}-${x}`))})}),e.jsx(C.Pagination,{pageQuantity:g.current_page*g.per_page,quantity:g.total,setMustLoad:S,setLimit:w,setPage:p,nextPage:g.next_page_url,prevPage:g.prev_page_url,page:g.current_page,lastPage:g.last_page,setMustAnimate:F})]}),e.jsx(ge,{image:V,open:K,setOpen:O}),e.jsx(fe,{product:G,option:z,open:q,setOpen:E,setMustLoad:S,setHelper:f}),e.jsx(re,{})]})}const be=Z.createRoot(document.getElementById("product"));be.render(e.jsx(ve,{}));
