import{r as t,j as e,g as ne,I as X,h as pe,i as ge,c as xe,H as he,d as fe,F as ye}from"./Footer-53ea2814.js";import{F as be}from"./Filters-4ad1a5e0.js";import{c as ve,d as je,s as Ne,Q as c,S as V,f as ie,T as de,u as J,a as K,M as re,b as O,L as Ce}from"./Spinner-fcab2623.js";import{R as le}from"./ReactSelect-15278dd7.js";import{S as oe}from"./Selector-b3a773a1.js";import{C as Se,i as _e}from"./initialStateCustomer-4c763343.js";import{B as Ee,i as we}from"./BreedModal-4be4f506.js";import{I as Fe}from"./ImageModal-c6940aca.js";function Me({petI:a,setPet:l,setOption:F,setOpenModal:m,setHelper:M,setMustLoad:P,setMustAnimate:g,setOpenImage:D,setImage:C,setIsDeleted:b}){var N,h,S,u,_,o;const[x,i]=t.useState(!1),d=()=>{Ne("¿Quieres eliminar esta mascota?",()=>{b(!0),g(!1);const v=c(e.jsx(V,{message:`Eliminando a ${a.name}`}),{autoClose:3e3,hideProgressBar:!0});ie("DELETE","/pets/destroy",{id:a.id}).then(f=>{if(P(!1),f.errors)return b(!1),c.update(v,{render:e.jsx(e.Fragment,{children:e.jsx(de,{data:f.errors})}),type:c.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});if(f.message)return b(!1),c.update(v,{render:e.jsx(e.Fragment,{children:f.message}),type:c.TYPE.INFO,autoClose:3e3,hideProgressBar:!1});c.update(v,{render:`Mascota ${a.name} ha sido eliminado.`,type:c.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),M(B=>B+1)}).catch(f=>{c.update(v,{render:"Hay problemas de conexión",type:c.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})})},"Se eliminarán los datos asociados a esta mascota como el historial de las mismas.")};return e.jsxs(e.Fragment,{children:[e.jsx("img",{className:"w-full h-60 object-cover",src:a.pet_image_url||"/image/mascota.webp",alt:a.name,onClick:()=>{C({url:a.pet_image_url||"/image/mascota.webp",label:a.name}),D(!0)}}),e.jsxs("div",{className:"px-8 pt-5 flex flex-col justify-between flex-1",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"uppercase tracking-wide text-sm text-indigo-500 font-semibold",children:["Nombre: ",a.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Edad: ",a.age]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Raza: ",(N=a.breed)==null?void 0:N.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Sexo: ",a.sex]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["C/E: ",a.ce]}),e.jsxs("p",{className:"mt-2 text-gray-700",children:["Dueño: ",(h=a.customer)==null?void 0:h.name," - ",(u=(S=a.customer)==null?void 0:S.identity_document)==null?void 0:u.abbreviation,": ",(_=a.customer)==null?void 0:_.document_number]}),e.jsxs("p",{className:"text-gray-700",children:["Fecha: ",ve(a.created_at)]}),e.jsx("p",{className:"text-gray-900",children:je(a.created_at)}),((o=a.observations)==null?void 0:o.length)>50?e.jsxs("div",{children:[e.jsx("button",{className:"bg-indigo-500 text-white font-semibold px-3 py-1 rounded-lg",onClick:()=>i(!0),children:"Observaciones"}),e.jsxs("article",{className:`${x?"-translate-y-0":"translate-y-full"} ease-in duration-150 absolute flex top-0 left-0 w-full h-full bg-vetgreen-200 text-black font-medium rounded-lg`,children:[e.jsx("button",{className:"fixed bg-red-900 text-white font-semibold px-3 py-1 rounded-lg top-1 right-0 me-5 mt-1 animate-bounce",onClick:()=>i(!1),children:"Cerrar"}),e.jsx("p",{className:"overflow-auto p-3 pt-8",children:a.observations})]})]}):e.jsxs("p",{className:"text-gray-700 font-semibold",children:[" ",e.jsx("strong",{children:"Observaciones:"})," ",a.observations||"---"]})]}),e.jsxs("div",{className:"my-3 flex gap-2",children:[e.jsx("button",{className:"bg-vetsky rounded-md py-1 px-4 font-semibold hover:bg-gray-400",onClick:()=>{F("Actualizar"),m(!0),l(a)},children:"Editar"}),e.jsx("button",{className:"bg-vetbrown rounded-md py-1 px-4 text-white font-semibold hover:bg-gray-500",onClick:d,children:"Eliminar"})]})]})]})}const n={id:"MODIFY_ID",name:"MODIFY_NAME",age:"MODIFY_AGE",customer_id:"MODIFY_CUSTOMER_ID",breed_id:"MODIFY_BREED_ID",sex:"MODIFY_SEX",ce:"MODIFY_CE",pet_image:"MODIFY_PET_IMAGE",observations:"MODIFY_OBSERVATIONS"};function Be(a,l){switch(l.type){case n.id:return{...a,id:l.payload||""};case n.name:return{...a,name:l.payload||""};case n.age:return{...a,age:l.payload||""};case n.customer_id:return{...a,customer_id:l.payload||""};case n.breed_id:return{...a,breed_id:l.payload||""};case n.sex:return{...a,sex:l.payload||""};case n.ce:return{...a,ce:l.payload||""};case n.pet_image:return{...a,pet_image:l.payload||""};case n.observations:return{...a,observations:l.payload||""};default:return a}}function Oe({pet:a,option:l,open:F,setOpen:m,setMustLoad:M,setHelper:P}){var Z,ee,ae,te;const g={method:"POST",url:l!=="Actualizar"?"/pets/store":"/pets/update",sucessMessage:l==="Crear"?"Mascota agregada":"Mascota actualizada",loadingMessage:l!=="Actualizar"?"Agregando mascota":"Actualizando mascota"},[D,C]=t.useState(!1),[b,x]=t.useState(!1),[i,d]=t.useReducer(Be,a),[N,h]=t.useState(!1),[S,u]=t.useState("name"),[_,o]=t.useState(""),[v,f]=t.useState(1),[B,H]=t.useState(!1),[T,G]=t.useState(!1),{debounceValue:R}=J(_,400),{data:z,loading:E}=K(`/customers/list?filter=${S}&inputFilter=${R}`,[v],T),[Y,j]=t.useState(""),[q,k]=t.useState(1),[Q,A]=t.useState(!1),[I,L]=t.useState(!1),{debounceValue:$}=J(Y,400),{data:r,loading:y}=K(`/breeds/list?filter=name&inputFilter=${$}`,[q],I),ce=s=>{s.preventDefault(),h(!0);const p=c(e.jsx(V,{message:g.loadingMessage}),{autoClose:3e4,hideProgressBar:!0});ie(g.method,g.url,i,!0).then(w=>{if(w.errors)return c.update(p,{render:e.jsx(e.Fragment,{children:e.jsx(de,{data:w.errors})}),type:c.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});c.update(p,{render:g.sucessMessage,type:c.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),M(!1),P(U=>U+1),m(!1)}).catch(w=>{console.log(w),c.update(p,{render:"Hay problemas de conexión",type:c.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})}).finally(()=>h(!1))};return t.useEffect(()=>{!E&&B&&f(s=>s+1)},[R]),t.useEffect(()=>{!y&&Q&&k(s=>s+1)},[$]),t.useEffect(()=>{var p,w,U,se;(p=a.customer)!=null&&p.name?o((w=a.customer)==null?void 0:w.name):o(""),(U=a.breed)!=null&&U.name?j((se=a.breed)==null?void 0:se.name):j("");const s=document.getElementById("pet_image");s.value="";for(const W in n){const ue=n[W],me=a.hasOwnProperty(W)?a[W]:"";d({type:ue,payload:me})}},[a]),e.jsxs(e.Fragment,{children:[e.jsxs(re,{option:l,open:F,setOpen:m,isLoading:N,handleSubmit:ce,icon:ne,text:"Mascota",children:[e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:i.name,onChange:s=>{d({type:n.name,payload:s.target.value})},required:!0,autoFocus:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Nombre"})]}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:i.age,onChange:s=>{d({type:n.age,payload:s.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Edad"})]}),e.jsxs("div",{className:"relative w-full col-span-full grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsx(le,{setMustSearch:H,filters:[{tag:"Nombre del dueño",value:"name"},{tag:"Número de documento",value:"document_number"}],filter:S,setFilter:u,input:_,setInput:o,label:"Dueño",setHelperSearch:G,setHelper:f,css:"w-full col-span-full order-1 pe-10",listStyle:"w-full max-h-72",children:E?e.jsx("div",{className:"w-full sm:w-1/2 mx-auto py-4",children:e.jsx(V,{message:"Buscando a los clientes ..."})}):((Z=z.data)==null?void 0:Z.length)===0?e.jsx("h3",{className:"cursor-pointer py-4 text-center",children:"No hay clientes con este dato ..."}):e.jsx("ul",{className:"px-5 py-2",children:(ee=z.data)==null?void 0:ee.map((s,p)=>e.jsx("li",{className:"cursor-pointer hover:bg-slate-600 rounded p-2",onClick:()=>{d({type:n.customer_id,payload:s.id}),H(!1),o(s.name)},children:`${s.name} - ${s.identity_document?`${s.identity_document.abbreviation}: ${s.document_number}`:"--"}`},p))})}),e.jsx("button",{type:"button",className:"order-1 absolute bottom-1 right-12 bg-gray-100 rounded-full px-2 py-1 z-10 hover:bg-gray-300",onClick:()=>C(!0),children:e.jsx(X,{icon:pe})})]}),e.jsx("div",{className:"absolute",children:e.jsx(Se,{customer:{..._e},option:"Crear",open:D,setOpen:C,actions:!1,mustBeToast:!1,focus:!1})}),e.jsxs("div",{className:"relative w-full col-span-full grid grid-cols-1 sm:grid-cols-2 gap-6 order-1",children:[e.jsx(le,{setMustSearch:A,input:Y,setInput:j,label:"Raza",setHelperSearch:L,setHelper:k,listStyle:"w-full max-h-72",children:y?e.jsx("div",{className:"w-full sm:w-1/2 mx-auto py-4",children:e.jsx(V,{message:"Buscando a las razas ..."})}):((ae=r.data)==null?void 0:ae.length)===0?e.jsx("h3",{className:"cursor-pointer py-4 text-center",children:"No hay razas con este dato ..."}):e.jsx("ul",{className:"px-5 py-2",children:(te=r.data)==null?void 0:te.map((s,p)=>e.jsx("li",{className:"cursor-pointer hover:bg-slate-600 rounded p-2",onClick:()=>{d({type:n.breed_id,payload:s.id}),A(!1),j(s.name)},children:s.name},p))})}),e.jsx("button",{type:"button",className:"order-1 absolute bottom-1 right-12 top-1 bg-gray-100 rounded-full px-2 py-1 z-10 hover:bg-gray-300",onClick:()=>x(!0),children:e.jsx(X,{icon:ge,size:"22px"})})]}),e.jsx("div",{className:"absolute",children:e.jsx(Ee,{breed:{...we},option:"Crear",open:b,setOpen:x,actions:!1,mustBeToast:!1,focus:!1})}),e.jsx(oe,{message:"Sexo",filters:[{tag:"Macho",value:"Macho"},{tag:"Hembra",value:"Hembra"}],filter:i.sex,setFilter:s=>d({type:n.sex,payload:s})}),e.jsx(oe,{message:"C/E",filters:[{tag:i.sex=="Hembra"?"Esterilizada":"Castrado",value:i.sex=="Hembra"?"Esterilizada":"Castrado"},{tag:"Entero",value:"Entero"}],filter:i.ce,setFilter:s=>d({type:n.ce,payload:s})}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full col-span-full order-1",children:[e.jsx("input",{type:"file",className:"hidden",id:"pet_image",accept:"image/*",onChange:s=>{const p=s.target.files&&s.target.files[0];d({type:n.pet_image,payload:p})}}),e.jsx("label",{htmlFor:"pet_image",className:"cursor-pointer block w-full py-2 text-center text-gray-600 bg-transparent rounded transition duration-200 ease-in-out hover:bg-gray-300",children:"--- Seleccionar foto (opcional) ---"})]}),i.pet_image&&e.jsx("img",{src:URL.createObjectURL(i.pet_image),alt:"mascota",className:"order-1 w-3/5 col-span-full mx-auto rounded-lg"}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full col-span-full order-1",children:[e.jsx("textarea",{className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",rows:"4",value:i.observations,onChange:s=>{d({type:n.observations,payload:s.target.value})}}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Observaciones (opcional)"})]})]}),e.jsx(re.ToastifyModal,{})]})}function Pe(){var I,L,$;const a={id:"",name:"",age:"",customer_id:"",breed_id:"",sex:"Macho",ce:"Entero",pet_image:null,observations:"No hay observaciones."},l=[{name:"Nombre",value:"name"},{name:"Nombre del dueño",value:"customer_id"},{name:"Número de documento del dueño",value:"document_number"},{name:"Raza",value:"breed_id"}],[F,m]=t.useState(1),[M,P]=t.useState(12),[g,D]=t.useState("name"),[C,b]=t.useState(""),[x,i]=t.useState(""),[d,N]=t.useState(""),{debounceValue:h}=J(C,500),[S,u]=t.useState(0),_=`/pets/list?page=${F}&limit=${M}&filter=${g}&inputFilter=${h}&startDate=${x}&finishDate=${d}`,{data:o,loading:v}=K(_,[F,M,S]),[f,B]=t.useState("Crear"),[H,T]=t.useState(!1),[G,R]=t.useState(a),[z,E]=t.useState(!0),[Y,j]=t.useState(!0),[q,k]=t.useState(!1),[Q,A]=t.useState({url:"",label:""});return t.useEffect(()=>{v||(E(!0),j(!0),m(1),u(r=>r+1))},[h]),e.jsxs(e.Fragment,{children:[e.jsx(he,{icon:ne,message:"Gestión de mascotas",name:"mascota",setOpen:T,setOption:B,setData:R,initialState:a}),e.jsx(be,{children:e.jsx("div",{className:"w-full flex justify-between flex-wrap sm:flex-nowrap gap-y-1",children:l.map((r,y)=>e.jsx("button",{className:`${g===r.value?"bg-vetgreen-200 text-white":"bg-vetgreen-100 hover:bg-vetgreen-200 hover:text-white"} cursor-pointer py-2 md:mx-2 mx-1 rounded-xl sm:rounded-full flex-grow`,onClick:()=>{D(r.value),b("")},children:r.name},y))})}),e.jsxs(O,{children:[e.jsxs(O.Search,{inputFilter:C,setInputFilter:b,handleReset:()=>{i(""),N(""),m(1),u(r=>r+1)},children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de inicio"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:x,onChange:r=>{i(r.target.value),m(1),u(y=>y+1)}})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de finalización"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:d,onChange:r=>{N(r.target.value),m(1),u(y=>y+1)}})]})]}),e.jsx(O.FilterBar,{hide:!h&&!x&&!d,data:[{tag:(I=l.find(r=>r.value===g))==null?void 0:I.name,input:h,handleClick:()=>b("")},{tag:"Fecha de inicio",input:x.length>0?x:null,handleClick:()=>{i(""),m(1),u(r=>r+1)}},{tag:"Fecha de finalización",input:d.length>0?d:null,handleClick:()=>{N(""),m(1),u(r=>r+1)}}]}),e.jsx(O.CardContainer,{children:v&z?e.jsx(Ce,{message:"Cargando mascotas"}):((L=o.data)==null?void 0:L.length)===0?e.jsx("div",{className:"bg-white p-4 border rounded shadow-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-lg",children:[e.jsx(X,{icon:fe,css:"mr-3"}),"No hay datos disponibles."]})}):e.jsx(e.Fragment,{children:($=o==null?void 0:o.data)==null?void 0:$.map((r,y)=>e.jsx(O.CardContainer.Card,{mustAnimate:Y,setMustAnimate:j,children:e.jsx(Me,{petI:r,setPet:R,setOption:B,setOpenModal:T,setHelper:u,setMustLoad:E,setMustAnimate:j,setOpenImage:k,setImage:A})},`${r.id}-${y}`))})}),e.jsx(O.Pagination,{pageQuantity:o.current_page*o.per_page,quantity:o.total,setMustLoad:E,setLimit:P,setPage:m,nextPage:o.next_page_url,prevPage:o.prev_page_url,page:o.current_page,lastPage:o.last_page,setMustAnimate:j})]}),e.jsx(Fe,{image:Q,open:q,setOpen:k}),e.jsx(Oe,{pet:G,option:f,open:H,setOpen:T,setMustLoad:E,setHelper:u}),e.jsx(ye,{})]})}const De=xe.createRoot(document.getElementById("pet"));De.render(e.jsx(Pe,{}));
