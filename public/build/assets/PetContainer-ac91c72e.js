import{r as s,j as e,g as le,I as oe,h as ue,c as me,H as pe,d as ge,F as xe}from"./Footer-a0a9b1e3.js";import{F as he}from"./Filters-47922677.js";import{c as fe,d as ye,s as be,Q as u,S as L,f as ne,T as ie,u as X,a as J,M as te,b as D,L as ve}from"./Spinner-66f4b8d4.js";import{R as se}from"./ReactSelect-d5de8baf.js";import{S as re}from"./Selector-83dcb330.js";import{C as je,i as Ne}from"./initialStateCustomer-aa191d24.js";import{I as Ce}from"./ImageModal-3e64c72f.js";function Se({petI:a,setPet:l,setOption:w,setOpenModal:m,setHelper:F,setMustLoad:B,setMustAnimate:g,setOpenImage:R,setImage:C,setIsDeleted:n}){var y,b,S,c,M,d;const[i,N]=s.useState(!1),x=()=>{be("¿Quieres eliminar esta mascota?",()=>{n(!0),g(!1);const v=u(e.jsx(L,{message:`Eliminando a ${a.name}`}),{autoClose:3e3,hideProgressBar:!0});ne("DELETE","/pets/destroy",{id:a.id}).then(h=>{if(B(!1),h.errors)return n(!1),u.update(v,{render:e.jsx(e.Fragment,{children:e.jsx(ie,{data:h.errors})}),type:u.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});if(h.message)return n(!1),u.update(v,{render:e.jsx(e.Fragment,{children:h.message}),type:u.TYPE.INFO,autoClose:3e3,hideProgressBar:!1});u.update(v,{render:`Mascota ${a.name} ha sido eliminado.`,type:u.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),F(P=>P+1)}).catch(h=>{u.update(v,{render:"Hay problemas de conexión",type:u.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})})},"Se eliminarán los datos asociados a esta mascota como el historial de las mismas.")};return e.jsxs(e.Fragment,{children:[e.jsx("img",{className:"w-full h-96 object-cover",src:a.pet_image_url||"/image/mascota.webp",alt:a.name,onClick:()=>{C({url:a.pet_image_url||"/image/mascota.webp",label:a.name}),R(!0)}}),e.jsxs("div",{className:"px-8 pt-5 flex flex-col justify-between flex-1",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"uppercase tracking-wide text-sm text-indigo-500 font-semibold",children:["Nombre: ",a.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Edad: ",a.age]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Raza: ",(y=a.breed)==null?void 0:y.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Sexo: ",a.sex]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["C/E: ",a.ce]}),e.jsxs("p",{className:"mt-2 text-gray-700",children:["Dueño: ",(b=a.customer)==null?void 0:b.name," - ",(c=(S=a.customer)==null?void 0:S.identity_document)==null?void 0:c.abbreviation,": ",(M=a.customer)==null?void 0:M.document_number]}),e.jsxs("p",{className:"text-gray-700",children:["Fecha: ",fe(a.created_at)]}),e.jsx("p",{className:"text-gray-900",children:ye(a.created_at)}),((d=a.observations)==null?void 0:d.length)>50?e.jsxs("div",{children:[e.jsx("button",{className:"bg-indigo-500 text-white font-semibold px-3 py-1 rounded-lg",onClick:()=>N(!0),children:"Observaciones"}),e.jsxs("article",{className:`${i?"-translate-y-0":"translate-y-full"} ease-in duration-150 absolute flex top-0 left-0 w-full h-full bg-vetgreen-200 text-black font-medium rounded-lg`,children:[e.jsx("button",{className:"fixed bg-red-900 text-white font-semibold px-3 py-1 rounded-lg top-1 right-0 me-5 mt-1 animate-bounce",onClick:()=>N(!1),children:"Cerrar"}),e.jsx("p",{className:"overflow-auto p-3 pt-8",children:a.observations})]})]}):e.jsxs("p",{className:"text-gray-700 font-semibold",children:[" ",e.jsx("strong",{children:"Observaciones:"})," ",a.observations||"---"]})]}),e.jsxs("div",{className:"my-3 flex gap-2",children:[e.jsx("button",{className:"bg-vetsky rounded-md py-1 px-4 font-semibold hover:bg-gray-400",onClick:()=>{w("Actualizar"),m(!0),l(a)},children:"Editar"}),e.jsx("button",{className:"bg-vetbrown rounded-md py-1 px-4 text-white font-semibold hover:bg-gray-500",onClick:x,children:"Eliminar"})]})]})]})}const o={id:"MODIFY_ID",name:"MODIFY_NAME",age:"MODIFY_AGE",customer_id:"MODIFY_CUSTOMER_ID",breed_id:"MODIFY_BREED_ID",sex:"MODIFY_SEX",ce:"MODIFY_CE",pet_image:"MODIFY_PET_IMAGE",observations:"MODIFY_OBSERVATIONS"};function _e(a,l){switch(l.type){case o.id:return{...a,id:l.payload||""};case o.name:return{...a,name:l.payload||""};case o.age:return{...a,age:l.payload||""};case o.customer_id:return{...a,customer_id:l.payload||""};case o.breed_id:return{...a,breed_id:l.payload||""};case o.sex:return{...a,sex:l.payload||""};case o.ce:return{...a,ce:l.payload||""};case o.pet_image:return{...a,pet_image:l.payload||""};case o.observations:return{...a,observations:l.payload||""};default:return a}}function Ee({pet:a,option:l,open:w,setOpen:m,setMustLoad:F,setHelper:B}){var f,K,Z,ee;const g={method:"POST",url:l!=="Actualizar"?"/pets/store":"/pets/update",sucessMessage:l==="Crear"?"Mascota agregada":"Mascota actualizada",loadingMessage:l!=="Actualizar"?"Agregando mascota":"Actualizando mascota"},[R,C]=s.useState(!1),[n,i]=s.useReducer(_e,a),[N,x]=s.useState(!1),[y,b]=s.useState("name"),[S,c]=s.useState(""),[M,d]=s.useState(1),[v,h]=s.useState(!1),[P,U]=s.useState(!1),{debounceValue:O}=X(S,400),{data:z,loading:T}=J(`/customers/list?filter=${y}&inputFilter=${O}`,[M],P),[A,j]=s.useState(""),[V,_]=s.useState(1),[G,k]=s.useState(!1),[q,Q]=s.useState(!1),{debounceValue:$}=X(A,400),{data:H,loading:Y}=J(`/breeds/list?filter=name&inputFilter=${$}`,[V],q),r=t=>{t.preventDefault(),x(!0);const p=u(e.jsx(L,{message:g.loadingMessage}),{autoClose:3e4,hideProgressBar:!0});ne(g.method,g.url,n,!0).then(E=>{if(E.errors)return u.update(p,{render:e.jsx(e.Fragment,{children:e.jsx(ie,{data:E.errors})}),type:u.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});u.update(p,{render:g.sucessMessage,type:u.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),F(!1),B(I=>I+1),m(!1)}).catch(E=>{console.log(E),u.update(p,{render:"Hay problemas de conexión",type:u.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})}).finally(()=>x(!1))};return s.useEffect(()=>{!T&&v&&d(t=>t+1)},[O]),s.useEffect(()=>{!Y&&G&&_(t=>t+1)},[$]),s.useEffect(()=>{var p,E,I,ae;(p=a.customer)!=null&&p.name?c((E=a.customer)==null?void 0:E.name):c(""),(I=a.breed)!=null&&I.name?j((ae=a.breed)==null?void 0:ae.name):j("");const t=document.getElementById("pet_image");t.value="";for(const W in o){const de=o[W],ce=a.hasOwnProperty(W)?a[W]:"";i({type:de,payload:ce})}},[a]),e.jsxs(e.Fragment,{children:[e.jsxs(te,{option:l,open:w,setOpen:m,isLoading:N,handleSubmit:r,icon:le,text:"Mascota",children:[e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:n.name,onChange:t=>{i({type:o.name,payload:t.target.value})},required:!0,autoFocus:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Nombre"})]}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:n.age,onChange:t=>{i({type:o.age,payload:t.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Edad"})]}),e.jsxs("div",{className:"relative w-full col-span-full grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsx(se,{setMustSearch:h,filters:[{tag:"Nombre del dueño",value:"name"},{tag:"Número de documento",value:"document_number"}],filter:y,setFilter:b,input:S,setInput:c,label:"Dueño",setHelperSearch:U,setHelper:d,css:"w-full col-span-full order-1 pe-10",listStyle:"w-full max-h-72",children:T?e.jsx("div",{className:"w-full sm:w-1/2 mx-auto py-4",children:e.jsx(L,{message:"Buscando a los clientes ..."})}):((f=z.data)==null?void 0:f.length)===0?e.jsx("h3",{className:"cursor-pointer py-4 text-center",children:"No hay clientes con este dato ..."}):e.jsx("ul",{className:"px-5 py-2",children:(K=z.data)==null?void 0:K.map((t,p)=>e.jsx("li",{className:"cursor-pointer hover:bg-slate-600 rounded p-2",onClick:()=>{i({type:o.customer_id,payload:t.id}),h(!1),c(t.name)},children:`${t.name} - ${t.identity_document?`${t.identity_document.abbreviation}: ${t.document_number}`:"--"}`},p))})}),e.jsx("button",{type:"button",className:"order-1 absolute bottom-1 right-12 bg-gray-100 rounded-full px-2 py-1 z-10 hover:bg-gray-300",onClick:()=>C(!0),children:e.jsx(oe,{icon:ue})})]}),e.jsx("div",{className:"absolute",children:e.jsx(je,{customer:{...Ne},option:"Crear",open:R,setOpen:C,actions:!1,mustBeToast:!1,focus:!1})}),e.jsx(se,{setMustSearch:k,input:A,setInput:j,label:"Raza",setHelperSearch:Q,setHelper:_,listStyle:"w-full max-h-72",children:Y?e.jsx("div",{className:"w-full sm:w-1/2 mx-auto py-4",children:e.jsx(L,{message:"Buscando a las razas ..."})}):((Z=H.data)==null?void 0:Z.length)===0?e.jsx("h3",{className:"cursor-pointer py-4 text-center",children:"No hay razas con este dato ..."}):e.jsx("ul",{className:"px-5 py-2",children:(ee=H.data)==null?void 0:ee.map((t,p)=>e.jsx("li",{className:"cursor-pointer hover:bg-slate-600 rounded p-2",onClick:()=>{i({type:o.breed_id,payload:t.id}),k(!1),j(t.name)},children:t.name},p))})}),e.jsx(re,{message:"Sexo",filters:[{tag:"Macho",value:"Macho"},{tag:"Hembra",value:"Hembra"}],filter:n.sex,setFilter:t=>i({type:o.sex,payload:t})}),e.jsx(re,{message:"C/E",filters:[{tag:n.sex=="Hembra"?"Esterilizada":"Castrado",value:n.sex=="Hembra"?"Esterilizada":"Castrado"},{tag:"Entero",value:"Entero"}],filter:n.ce,setFilter:t=>i({type:o.ce,payload:t})}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full col-span-full order-1",children:[e.jsx("input",{type:"file",className:"hidden",id:"pet_image",accept:"image/*",onChange:t=>{const p=t.target.files&&t.target.files[0];i({type:o.pet_image,payload:p})}}),e.jsx("label",{htmlFor:"pet_image",className:"cursor-pointer block w-full py-2 text-center text-gray-600 bg-transparent rounded transition duration-200 ease-in-out hover:bg-gray-300",children:"--- Seleccionar foto (opcional) ---"})]}),n.pet_image&&e.jsx("img",{src:URL.createObjectURL(n.pet_image),alt:"mascota",className:"order-1 w-3/5 col-span-full mx-auto rounded-lg"}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full col-span-full order-1",children:[e.jsx("textarea",{className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",rows:"4",value:n.observations,onChange:t=>{i({type:o.observations,payload:t.target.value})}}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Observaciones (opcional)"})]})]}),e.jsx(te.ToastifyModal,{})]})}function we(){var $,H,Y;const a={id:"",name:"",age:"",customer_id:"",breed_id:"",sex:"Macho",ce:"Entero",pet_image:null,observations:"No hay observaciones."},l=[{name:"Nombre",value:"name"},{name:"Nombre del dueño",value:"customer_id"},{name:"Número de documento del dueño",value:"document_number"},{name:"Raza",value:"breed_id"}],[w,m]=s.useState(1),[F,B]=s.useState(12),[g,R]=s.useState("name"),[C,n]=s.useState(""),[i,N]=s.useState(""),[x,y]=s.useState(""),{debounceValue:b}=X(C,500),[S,c]=s.useState(0),M=`/pets/list?page=${w}&limit=${F}&filter=${g}&inputFilter=${b}&startDate=${i}&finishDate=${x}`,{data:d,loading:v}=J(M,[w,F,S]),[h,P]=s.useState("Crear"),[U,O]=s.useState(!1),[z,T]=s.useState(a),[A,j]=s.useState(!0),[V,_]=s.useState(!0),[G,k]=s.useState(!1),[q,Q]=s.useState({url:"",label:""});return s.useEffect(()=>{v||(j(!0),_(!0),m(1),c(r=>r+1))},[b]),e.jsxs(e.Fragment,{children:[e.jsx(pe,{icon:le,message:"Gestión de mascotas",name:"mascota",setOpen:O,setOption:P,setData:T,initialState:a}),e.jsx(he,{children:e.jsx("div",{className:"w-full flex justify-between flex-wrap sm:flex-nowrap gap-y-1",children:l.map((r,f)=>e.jsx("button",{className:`${g===r.value?"bg-vetgreen-200 text-white":"bg-vetgreen-100 hover:bg-vetgreen-200 hover:text-white"} cursor-pointer py-2 md:mx-2 mx-1 rounded-xl sm:rounded-full flex-grow`,onClick:()=>{R(r.value),n("")},children:r.name},f))})}),e.jsxs(D,{children:[e.jsxs(D.Search,{inputFilter:C,setInputFilter:n,handleReset:()=>{N(""),y(""),m(1),c(r=>r+1)},children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de inicio"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:i,onChange:r=>{N(r.target.value),m(1),c(f=>f+1)}})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de finalización"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:x,onChange:r=>{y(r.target.value),m(1),c(f=>f+1)}})]})]}),e.jsx(D.FilterBar,{hide:!b&&!i&&!x,data:[{tag:($=l.find(r=>r.value===g))==null?void 0:$.name,input:b,handleClick:()=>n("")},{tag:"Fecha de inicio",input:i.length>0?i:null,handleClick:()=>{N(""),m(1),c(r=>r+1)}},{tag:"Fecha de finalización",input:x.length>0?x:null,handleClick:()=>{y(""),m(1),c(r=>r+1)}}]}),e.jsx(D.CardContainer,{children:v&A?e.jsx(ve,{message:"Cargando mascotas"}):((H=d.data)==null?void 0:H.length)===0?e.jsx("div",{className:"bg-white p-4 border rounded shadow-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-lg",children:[e.jsx(oe,{icon:ge,css:"mr-3"}),"No hay datos disponibles."]})}):e.jsx(e.Fragment,{children:(Y=d==null?void 0:d.data)==null?void 0:Y.map((r,f)=>e.jsx(D.CardContainer.Card,{mustAnimate:V,setMustAnimate:_,children:e.jsx(Se,{petI:r,setPet:T,setOption:P,setOpenModal:O,setHelper:c,setMustLoad:j,setMustAnimate:_,setOpenImage:k,setImage:Q})},`${r.id}-${f}`))})}),e.jsx(D.Pagination,{pageQuantity:d.current_page*d.per_page,quantity:d.total,setMustLoad:j,setLimit:B,setPage:m,nextPage:d.next_page_url,prevPage:d.prev_page_url,page:d.current_page,lastPage:d.last_page,setMustAnimate:_})]}),e.jsx(Ce,{image:q,open:G,setOpen:k}),e.jsx(Ee,{pet:z,option:h,open:U,setOpen:O,setMustLoad:j,setHelper:c}),e.jsx(xe,{})]})}const Fe=me.createRoot(document.getElementById("pet"));Fe.render(e.jsx(we,{}));
