import{r as t,j as e,h as le,i as de,I as K,k as ge,l as xe,d as he,H as fe,e as be,F as ye}from"./Footer-5a793555.js";import{F as ve}from"./Filters-5c1cd9b5.js";import{c as je,d as Ne,s as Se,Q as u,S as Q,f as ce,T as ue,u as Z,a as ee,M as oe,b as T,L as Ce}from"./Spinner-0b2ec88a.js";import{R as ne}from"./ReactSelect-a5a841a5.js";import{S as ie}from"./Selector-eee34858.js";import{C as _e,i as Ee}from"./initialStateCustomer-11164938.js";import{B as we,i as Fe}from"./BreedModal-2a3c8711.js";import{I as Me}from"./ImageModal-6e5161c6.js";function Be({petI:a,setPet:l,setOption:F,setOpenModal:m,setHelper:M,setMustLoad:$,setMustAnimate:h,setImage:B,transitionName:S,setTransitionName:N,setIsDeleted:p}){var f,y,v,_,d,P;const[c,i]=t.useState(!1),C=()=>{Se("¿Quieres eliminar esta mascota?",()=>{p(!0),h(!1);const o=u(e.jsx(Q,{message:`Eliminando a ${a.name}`}),{autoClose:3e3,hideProgressBar:!0});ce("DELETE","/pets/destroy",{id:a.id}).then(b=>{if($(!1),b.errors)return p(!1),u.update(o,{render:e.jsx(e.Fragment,{children:e.jsx(ue,{data:b.errors})}),type:u.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});if(b.message)return p(!1),u.update(o,{render:e.jsx(e.Fragment,{children:b.message}),type:u.TYPE.INFO,autoClose:3e3,hideProgressBar:!1});u.update(o,{render:`Mascota ${a.name} ha sido eliminado.`,type:u.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),M(D=>D+1)}).catch(b=>{u.update(o,{render:"Hay problemas de conexión",type:u.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})})},"Se eliminarán los datos asociados a esta mascota como el historial de las mismas.")};return e.jsxs(e.Fragment,{children:[e.jsx("img",{className:"w-full h-60 object-cover",src:a.pet_image_url,alt:a.name,onClick:()=>{document.startViewTransition?document.startViewTransition(()=>{le.flushSync(()=>{N(`${a.name}-${a.id}`),B({url:a.pet_image_url,label:a.name})})}):le.flushSync(()=>{N(`${a.name}-${a.id}`),B({url:a.pet_image_url,label:a.name})})},style:{viewTransitionName:!S&&`${a.name}-${a.id}`}}),e.jsxs("div",{className:"px-8 pt-5 flex flex-col justify-between flex-1",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"uppercase tracking-wide text-sm text-indigo-500 font-semibold",children:["Nombre: ",a.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Edad: ",a.age]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Raza: ",(f=a.breed)==null?void 0:f.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Sexo: ",a.sex]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["C/E: ",a.ce]}),e.jsxs("p",{className:"mt-2 text-gray-700",children:["Dueño: ",(y=a.customer)==null?void 0:y.name," - ",(_=(v=a.customer)==null?void 0:v.identity_document)==null?void 0:_.abbreviation,": ",(d=a.customer)==null?void 0:d.document_number]}),e.jsxs("p",{className:"text-gray-700",children:["Fecha: ",je(a.created_at)]}),((P=a.observations)==null?void 0:P.length)>50?e.jsxs("div",{children:[e.jsx("button",{className:"bg-indigo-500 text-white font-semibold px-3 py-1 rounded-lg",onClick:()=>i(!0),children:"Observaciones"}),e.jsxs("article",{className:`${c?"-translate-y-0":"translate-y-full"} ease-in duration-150 absolute flex top-0 left-0 w-full h-full bg-vetgreen-200 text-black font-medium rounded-lg`,children:[e.jsx("button",{className:"fixed bg-red-900 text-white font-semibold px-3 py-1 rounded-lg top-1 right-0 me-5 mt-1 animate-bounce",onClick:()=>i(!1),children:"Cerrar"}),e.jsx("p",{className:"overflow-auto p-3 pt-8",children:a.observations})]})]}):e.jsxs("p",{className:"text-gray-700 font-semibold",children:[" ",e.jsx("strong",{children:"Observaciones:"})," ",a.observations||"---"]})]}),e.jsxs("div",{className:"my-3 flex gap-2 pb-4",children:[e.jsx("button",{className:"bg-vetsky rounded-md py-1 px-4 font-semibold hover:bg-gray-400",onClick:()=>{F("Actualizar"),m(!0),l(a)},children:"Editar"}),e.jsx("button",{className:"bg-vetbrown rounded-md py-1 px-4 text-white font-semibold hover:bg-gray-500",onClick:C,children:"Eliminar"})]}),e.jsxs("p",{className:"text-gray-600 font-medium text-sm absolute bottom-1 right-6",children:["Agregado ",Ne(a.created_at)]})]})]})}const n={id:"MODIFY_ID",name:"MODIFY_NAME",age:"MODIFY_AGE",customer_id:"MODIFY_CUSTOMER_ID",breed_id:"MODIFY_BREED_ID",sex:"MODIFY_SEX",ce:"MODIFY_CE",pet_image:"MODIFY_PET_IMAGE",observations:"MODIFY_OBSERVATIONS"};function Pe(a,l){switch(l.type){case n.id:return{...a,id:l.payload||""};case n.name:return{...a,name:l.payload||""};case n.age:return{...a,age:l.payload||""};case n.customer_id:return{...a,customer_id:l.payload||""};case n.breed_id:return{...a,breed_id:l.payload||""};case n.sex:return{...a,sex:l.payload||""};case n.ce:return{...a,ce:l.payload||""};case n.pet_image:return{...a,pet_image:l.payload||""};case n.observations:return{...a,observations:l.payload||""};default:return a}}function De({pet:a,option:l,open:F,setOpen:m,setMustLoad:M,setHelper:$}){var g,ae,te,se;const h={method:"POST",url:l!=="Actualizar"?"/pets/store":"/pets/update",sucessMessage:l==="Crear"?"Mascota agregada":"Mascota actualizada",loadingMessage:l!=="Actualizar"?"Agregando mascota":"Actualizando mascota"},[B,S]=t.useState(!1),[N,p]=t.useState(!1),[c,i]=t.useReducer(Pe,a),[C,f]=t.useState(!1),[y,v]=t.useState("name"),[_,d]=t.useState(""),[P,o]=t.useState(1),[b,D]=t.useState(!1),[A,W]=t.useState(!1),{debounceValue:O}=Z(_,400),{data:L,loading:R}=ee(`/customers/list?filter=${y}&inputFilter=${O}`,[P],A),[V,j]=t.useState(""),[I,E]=t.useState(1),[X,U]=t.useState(!1),[k,G]=t.useState(!1),{debounceValue:H}=Z(V,400),{data:z,loading:Y}=ee(`/breeds/list?filter=name&inputFilter=${H}`,[I],k),r=s=>{s.preventDefault(),f(!0);const x=u(e.jsx(Q,{message:h.loadingMessage}),{autoClose:3e4,hideProgressBar:!0});ce(h.method,h.url,c,!0).then(w=>{if(w.errors)return u.update(x,{render:e.jsx(e.Fragment,{children:e.jsx(ue,{data:w.errors})}),type:u.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});u.update(x,{render:h.sucessMessage,type:u.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),M(!1),$(q=>q+1),m(!1)}).catch(w=>{console.log(w),u.update(x,{render:"Hay problemas de conexión",type:u.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})}).finally(()=>f(!1))};return t.useEffect(()=>{!R&&b&&o(s=>s+1)},[O]),t.useEffect(()=>{!Y&&X&&E(s=>s+1)},[H]),t.useEffect(()=>{var x,w,q,re;(x=a.customer)!=null&&x.name?d((w=a.customer)==null?void 0:w.name):d(""),(q=a.breed)!=null&&q.name?j((re=a.breed)==null?void 0:re.name):j("");const s=document.getElementById("pet_image");s.value="";for(const J in n){const me=n[J],pe=a.hasOwnProperty(J)?a[J]:"";i({type:me,payload:pe})}},[a]),e.jsxs(e.Fragment,{children:[e.jsxs(oe,{option:l,open:F,setOpen:m,isLoading:C,handleSubmit:r,icon:de,text:"Mascota",children:[e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:c.name,onChange:s=>{i({type:n.name,payload:s.target.value})},required:!0,autoFocus:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Nombre"})]}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:c.age,onChange:s=>{i({type:n.age,payload:s.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Edad"})]}),e.jsxs("div",{className:"relative w-full col-span-full grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsx(ne,{setMustSearch:D,filters:[{tag:"Nombre del dueño",value:"name"},{tag:"Número de documento",value:"document_number"}],filter:y,setFilter:v,input:_,setInput:d,label:"Dueño",setHelperSearch:W,setHelper:o,css:"w-full col-span-full order-1 pe-10",listStyle:"w-full max-h-72",children:R?e.jsx("div",{className:"w-full sm:w-1/2 mx-auto py-4",children:e.jsx(Q,{message:"Buscando a los clientes ..."})}):((g=L.data)==null?void 0:g.length)===0?e.jsx("h3",{className:"cursor-pointer py-4 text-center",children:"No hay clientes con este dato ..."}):e.jsx("ul",{className:"px-5 py-2",children:(ae=L.data)==null?void 0:ae.map((s,x)=>e.jsx("li",{className:"cursor-pointer hover:bg-slate-600 rounded p-2",onClick:()=>{i({type:n.customer_id,payload:s.id}),D(!1),d(s.name)},children:`${s.name} - ${s.identity_document?`${s.identity_document.abbreviation}: ${s.document_number}`:"--"}`},x))})}),e.jsx("button",{type:"button",className:"order-1 absolute bottom-1 right-12 bg-gray-100 rounded-full px-2 py-1 z-10 hover:bg-gray-300",onClick:()=>S(!0),children:e.jsx(K,{icon:ge})})]}),e.jsx("div",{className:"absolute",children:e.jsx(_e,{customer:{...Ee},option:"Crear",open:B,setOpen:S,actions:!1,mustBeToast:!1,focus:!1})}),e.jsxs("div",{className:"relative w-full col-span-full grid grid-cols-1 sm:grid-cols-2 gap-6 order-1",children:[e.jsx(ne,{setMustSearch:U,input:V,setInput:j,label:"Raza",setHelperSearch:G,setHelper:E,listStyle:"w-full max-h-72",children:Y?e.jsx("div",{className:"w-full sm:w-1/2 mx-auto py-4",children:e.jsx(Q,{message:"Buscando a las razas ..."})}):((te=z.data)==null?void 0:te.length)===0?e.jsx("h3",{className:"cursor-pointer py-4 text-center",children:"No hay razas con este dato ..."}):e.jsx("ul",{className:"px-5 py-2",children:(se=z.data)==null?void 0:se.map((s,x)=>e.jsx("li",{className:"cursor-pointer hover:bg-slate-600 rounded p-2",onClick:()=>{i({type:n.breed_id,payload:s.id}),U(!1),j(s.name)},children:s.name},x))})}),e.jsx("button",{type:"button",className:"order-1 absolute bottom-1 right-12 top-1 bg-gray-100 rounded-full px-2 py-1 z-10 hover:bg-gray-300",onClick:()=>p(!0),children:e.jsx(K,{icon:xe,size:"22px"})})]}),e.jsx("div",{className:"absolute",children:e.jsx(we,{breed:{...Fe},option:"Crear",open:N,setOpen:p,actions:!1,mustBeToast:!1,focus:!1})}),e.jsx(ie,{message:"Sexo",filters:[{tag:"Macho",value:"Macho"},{tag:"Hembra",value:"Hembra"}],filter:c.sex,setFilter:s=>i({type:n.sex,payload:s})}),e.jsx(ie,{message:"C/E",filters:[{tag:c.sex=="Hembra"?"Esterilizada":"Castrado",value:c.sex=="Hembra"?"Esterilizada":"Castrado"},{tag:"Entero",value:"Entero"}],filter:c.ce,setFilter:s=>i({type:n.ce,payload:s})}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full col-span-full order-1",children:[e.jsx("input",{type:"file",className:"hidden",id:"pet_image",accept:"image/*",onChange:s=>{const x=s.target.files&&s.target.files[0];i({type:n.pet_image,payload:x})}}),e.jsx("label",{htmlFor:"pet_image",className:"cursor-pointer block w-full py-2 text-center text-gray-600 bg-transparent rounded transition duration-200 ease-in-out hover:bg-gray-300",children:"--- Seleccionar foto (opcional) ---"})]}),c.pet_image&&e.jsx("img",{src:URL.createObjectURL(c.pet_image),alt:"mascota",className:"order-1 w-3/5 col-span-full mx-auto rounded-lg"}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full col-span-full order-1",children:[e.jsx("textarea",{className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",rows:"4",value:c.observations,onChange:s=>{i({type:n.observations,payload:s.target.value})}}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Observaciones (opcional)"})]})]}),e.jsx(oe.ToastifyModal,{})]})}function Oe(){var H,z,Y;const a={id:"",name:"",age:"",customer_id:"",breed_id:"",sex:"Macho",ce:"Entero",pet_image:null,observations:"No hay observaciones."},l=[{name:"Nombre",value:"name"},{name:"Nombre del dueño",value:"customer_id"},{name:"Número de documento del dueño",value:"document_number"},{name:"Raza",value:"breed_id"}],[F,m]=t.useState(1),[M,$]=t.useState(12),[h,B]=t.useState("name"),[S,N]=t.useState(""),[p,c]=t.useState(""),[i,C]=t.useState(""),[f,y]=t.useState(""),{debounceValue:v}=Z(S,500),[_,d]=t.useState(0),P=`/pets/list?page=${F}&limit=${M}&filter=${h}&inputFilter=${v}&sex=${p}&startDate=${i}&finishDate=${f}`,{data:o,loading:b}=ee(P,[F,M,_]),[D,A]=t.useState("Crear"),[W,O]=t.useState(!1),[L,R]=t.useState(a),[V,j]=t.useState(!0),[I,E]=t.useState(!0),[X,U]=t.useState({url:"",label:""}),[k,G]=t.useState("");return t.useEffect(()=>{b||(j(!0),E(!0),m(1),d(r=>r+1))},[v]),e.jsxs(e.Fragment,{children:[e.jsx(fe,{icon:de,message:"Gestión de mascotas",name:"mascota",setOpen:O,setOption:A,setData:R,initialState:a}),e.jsx(ve,{children:e.jsx("div",{className:"w-full flex justify-between flex-wrap sm:flex-nowrap gap-y-1",children:l.map((r,g)=>e.jsx("button",{className:`${h===r.value?"bg-vetgreen-200 text-white":"bg-vetgreen-100 hover:bg-vetgreen-200 hover:text-white"} cursor-pointer py-2 md:mx-2 mx-1 rounded-xl sm:rounded-full flex-grow`,onClick:()=>{B(r.value),N("")},children:r.name},g))})}),e.jsxs(T,{children:[e.jsxs(T.Search,{inputFilter:S,setInputFilter:N,handleReset:()=>{c(""),C(""),y(""),m(1),d(r=>r+1)},filter:h,filters:l,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Sexo de la mascota"}),e.jsxs("select",{className:"p-2 rounded-xl bg-gray-300 w-full",value:p,onChange:r=>{c(r.target.value),m(1),d(g=>g+1)},children:[e.jsx("option",{value:"",children:"Ambos"}),e.jsx("option",{value:"Macho",children:"Macho"}),e.jsx("option",{value:"Hembra",children:"Hembra"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de inicio"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:i,onChange:r=>{C(r.target.value),m(1),d(g=>g+1)}})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de finalización"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:f,onChange:r=>{y(r.target.value),m(1),d(g=>g+1)}})]})]}),e.jsx(T.FilterBar,{hide:!v&&!p&&!i&&!f,data:[{tag:(H=l.find(r=>r.value===h))==null?void 0:H.name,input:v,handleClick:()=>N("")},{tag:"Sexo de la mascota",input:p.length>0?p:null,handleClick:()=>{c(""),m(1),d(r=>r+1)}},{tag:"Fecha de inicio",input:i.length>0?i:null,handleClick:()=>{C(""),m(1),d(r=>r+1)}},{tag:"Fecha de finalización",input:f.length>0?f:null,handleClick:()=>{y(""),m(1),d(r=>r+1)}}]}),e.jsx(T.CardContainer,{children:b&V?e.jsx(Ce,{message:"Cargando mascotas"}):((z=o.data)==null?void 0:z.length)===0?e.jsx("div",{className:"bg-white p-4 border rounded shadow-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-lg",children:[e.jsx(K,{icon:be,css:"mr-3"}),"No hay datos disponibles."]})}):e.jsx(e.Fragment,{children:(Y=o==null?void 0:o.data)==null?void 0:Y.map((r,g)=>e.jsx(T.CardContainer.Card,{mustAnimate:I,setMustAnimate:E,children:e.jsx(Be,{petI:r,setPet:R,setOption:A,setOpenModal:O,setHelper:d,setMustLoad:j,setMustAnimate:E,setImage:U,transitionName:k,setTransitionName:G})},`${r.id}-${g}`))})}),e.jsx(T.Pagination,{pageQuantity:o.current_page*o.per_page,quantity:o.total,setMustLoad:j,setLimit:$,setPage:m,nextPage:o.next_page_url,prevPage:o.prev_page_url,page:o.current_page,lastPage:o.last_page,setMustAnimate:E})]}),k&&e.jsx(Me,{image:X,transitionName:k,setTransitionName:G}),e.jsx(De,{pet:L,option:D,open:W,setOpen:O,setMustLoad:j,setHelper:d}),e.jsx(ye,{})]})}const Te=he.createRoot(document.getElementById("pet"));Te.render(e.jsx(Oe,{}));
