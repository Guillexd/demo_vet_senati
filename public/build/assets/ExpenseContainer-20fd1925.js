import{j as e,r as s,q as U,d as G,H as Q,s as W,I as q,e as V,F as J}from"./Footer-890d0c98.js";import{F as K}from"./Filters-4780ecd9.js";import{s as X,Q as r,S as _,f as B,T as O,M,u as Z,a as ee,b as v,L as ae}from"./Spinner-1f1ad60d.js";function te({expenseI:t,setExpense:n,setOption:j,setOpenModal:i,setHelper:b,setMustLoad:C,setMustAnimate:d,setIsDeleted:x}){const h=()=>{X("¿Quieres eliminar esta razón?",()=>{x(!0),d(!1);const p=r(e.jsx(_,{message:`Eliminando a ${t.reason}`}),{autoClose:3e3,hideProgressBar:!0});B("DELETE","/expenses/destroy",{id:t.id}).then(o=>{if(C(!1),o.errors)return x(!1),r.update(p,{render:e.jsx(e.Fragment,{children:e.jsx(O,{data:o.errors})}),type:r.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});if(o.message)return x(!1),r.update(p,{render:e.jsx(e.Fragment,{children:o.message}),type:r.TYPE.INFO,autoClose:3e3,hideProgressBar:!1});r.update(p,{render:`Razón ${t.reason} ha sido eliminada.`,type:r.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),b(f=>f+1)}).catch(o=>{r.update(p,{render:"Hay problemas de conexión",type:r.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})})})};return e.jsxs("div",{className:"flex flex-wrap flex-col justify-between lg:flex-row p-2 md:p-3 md:mx-5",children:[e.jsxs("p",{className:"uppercase tracking-wide text-sm text-indigo-500 font-semibold text-center md:text-start lg:w-9/12",children:[e.jsx("strong",{children:"Razón de egreso:"})," ",t.reason]}),e.jsxs("div",{className:"my-3 flex justify-center items-center gap-2",children:[e.jsx("button",{className:"bg-vetsky rounded-md py-1 px-4 font-semibold hover:bg-gray-400",onClick:()=>{j("Actualizar"),i(!0),n(t)},children:"Editar"}),e.jsx("button",{className:"bg-vetbrown rounded-md py-1 px-4 text-white font-semibold hover:bg-gray-500",onClick:h,children:"Eliminar"})]})]})}const E={id:"MODIFY_ID",reason:"MODIFY_REASON"};function se(t,n){switch(n.type){case E.id:return{...t,id:n.payload};case E.reason:return{...t,reason:n.payload};default:return t}}function re({expense:t,option:n,open:j,setOpen:i,setMustLoad:b,setHelper:C}){const d={method:n==="Crear"?"POST":"PUT",url:n!=="Actualizar"?"/expenses/store":"/expenses/update",sucessMessage:n==="Crear"?"Razón agregada":"Razón actualizada",loadingMessage:n!=="Actualizar"?"Agregando razón":"Actualizando razón"},[x,h]=s.useReducer(se,t),[p,o]=s.useState(!1),f=l=>{l.preventDefault(),o(!0);const g=r(e.jsx(_,{message:d.loadingMessage}),{autoClose:1e4,hideProgressBar:!0});B(d.method,d.url,x).then(c=>{if(c.errors)return r.update(g,{render:e.jsx(e.Fragment,{children:e.jsx(O,{data:c.errors})}),type:r.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});r.update(g,{render:d.sucessMessage,type:r.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),b(!1),C(P=>P+1),i(!1)}).catch(c=>{console.log(c),r.update(g,{render:"Hay problemas de conexión",type:r.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})}).finally(()=>o(!1))};return s.useEffect(()=>{for(const l in E){const g=E[l],c=t.hasOwnProperty(l)?t[l]:"";h({type:g,payload:c})}},[t]),e.jsxs(e.Fragment,{children:[e.jsx(M,{option:n,open:j,setOpen:i,isLoading:p,handleSubmit:f,icon:U,text:"Razón",children:e.jsxs("div",{className:"relative border border-gray-600 rounded w-full col-span-full order-1",children:[e.jsx("textarea",{className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",rows:"4",value:x.reason,onChange:l=>{h({type:E.reason,payload:l.target.value})}}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Razón de egreso"})]})}),e.jsx(M.ToastifyModal,{})]})}function ne(){var z,D,A;const t={id:"",reason:""},n=[{name:"Razón",value:"reason"}],[j,i]=s.useState(1),[b,C]=s.useState(12),[d,x]=s.useState("reason"),[h,p]=s.useState(""),[o,f]=s.useState(""),[l,g]=s.useState(""),{debounceValue:c}=Z(h,500),[P,m]=s.useState(0),$=`/expenses/list?page=${j}&limit=${b}&filter=${d}&inputFilter=${c}&startDate=${o}&finishDate=${l}`,{data:u,loading:w}=ee($,[j,b,P]),[k,R]=s.useState("Crear"),[Y,F]=s.useState(!1),[L,T]=s.useState(t),[H,S]=s.useState(!0),[I,N]=s.useState(!0);return s.useEffect(()=>{w||(S(!0),N(!0),i(1),m(a=>a+1))},[c]),e.jsxs(e.Fragment,{children:[e.jsx(Q,{icon:W,message:"Gestión de egresos",name:"egreso",setOpen:F,setOption:R,setData:T,initialState:t}),e.jsx(K,{children:n.map((a,y)=>e.jsx("button",{className:`${d===a.value?"bg-vetgreen-200 text-white":"bg-vetgreen-100 hover:bg-vetgreen-200 hover:text-white"} cursor-pointer p-2 rounded-md flex-grow`,onClick:()=>{x(a.value),p("")},children:a.name},y))}),e.jsxs(v,{children:[e.jsxs(v.Search,{inputFilter:h,setInputFilter:p,handleReset:()=>{f(""),g(""),i(1),m(a=>a+1)},filter:d,filters:n,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de inicio"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:o,onChange:a=>{f(a.target.value),i(1),m(y=>y+1)}})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de finalización"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:l,onChange:a=>{g(a.target.value),i(1),m(y=>y+1)}})]})]}),e.jsx(v.FilterBar,{hide:!c&&!o&&!l,data:[{tag:(z=n.find(a=>a.value===d))==null?void 0:z.name,input:c,handleClick:()=>p("")},{tag:"Fecha de inicio",input:o.length>0?o:null,handleClick:()=>{f(""),i(1),m(a=>a+1)}},{tag:"Fecha de finalización",input:l.length>0?l:null,handleClick:()=>{g(""),i(1),m(a=>a+1)}}]}),e.jsx(v.CardContainer,{children:w&H?e.jsx(ae,{message:"Cargando razones de egreso"}):((D=u.data)==null?void 0:D.length)===0?e.jsx("div",{className:"bg-white p-4 border rounded shadow-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-lg",children:[e.jsx(q,{icon:V,css:"mr-3"}),"No hay datos disponibles."]})}):e.jsx(e.Fragment,{children:(A=u==null?void 0:u.data)==null?void 0:A.map((a,y)=>e.jsx(v.CardContainer.Card,{mustAnimate:I,setMustAnimate:N,width:"w-full",children:e.jsx(te,{expenseI:a,setExpense:T,setOption:R,setOpenModal:F,setHelper:m,setMustLoad:S,setMustAnimate:N})},`${a.id}-${y}`))})}),e.jsx(v.Pagination,{pageQuantity:u.current_page*u.per_page,quantity:u.total,setMustLoad:S,setLimit:C,setPage:i,nextPage:u.next_page_url,prevPage:u.prev_page_url,page:u.current_page,lastPage:u.last_page,setMustAnimate:N})]}),e.jsx(re,{expense:L,option:k,open:Y,setOpen:F,setMustLoad:S,setHelper:m}),e.jsx(J,{})]})}const oe=G.createRoot(document.getElementById("expense"));oe.render(e.jsx(ne,{}));
