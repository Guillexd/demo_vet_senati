import{r as o,j as e,f as $,I as P,a as J,b as Y,c as U,d as K,H as X,e as Z,F as ee}from"./Footer-5a793555.js";import{F as ae}from"./Filters-5c1cd9b5.js";import{M as L,Q as c,f as z,T as q,S as B,g as te,d as re,s as ne,u as se,a as oe,b as w,L as le}from"./Spinner-21315384.js";const s={id:"MODIFY_ID",name:"MODIFY_NAME",email:"MODIFY_EMAIL",rol_id:"MODIFY_ROL",dni:"MODIFY_DNI",phone:"MODIFY_PHONE",direction:"MODIFY_DIRECTION",password:"MODIFY_PASSWORD",password_confirmation:"MODIFY_PASSWORD_CONFIRMATION"};function ie(t,n){switch(n.type){case s.id:return{...t,id:n.payload};case s.name:return{...t,name:n.payload};case s.email:return{...t,email:n.payload};case s.rol_id:return{...t,rol_id:n.payload};case s.dni:return{...t,dni:n.payload};case s.phone:return{...t,phone:n.payload};case s.direction:return{...t,direction:n.payload};case s.password:return{...t,password:n.payload};case s.password_confirmation:return{...t,password_confirmation:n.payload};default:return t}}function de({user:t,option:n,open:b,setOpen:p,setMustLoad:j,setHelper:C}){const[x,N]=o.useState(!1),[v,g]=o.useState(!1),u={method:n==="Crear"?"POST":"PUT",url:n!=="Actualizar"?"/users/store":"/users/update",sucessMessage:n==="Crear"?"Usuario agregado":"Usuario actualizado",loadingMessage:n!=="Actualizar"?"Agregando usuario":"Actualizando usuario"},[i,d]=o.useReducer(ie,t),[_,y]=o.useState(!1),S=a=>{a.preventDefault(),y(!0);const m=c(e.jsx(B,{message:u.loadingMessage}),{autoClose:1e4,hideProgressBar:!0});z(u.method,u.url,i).then(l=>{if(l.errors)return c.update(m,{render:e.jsx(e.Fragment,{children:e.jsx(q,{data:l.errors})}),type:c.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});c.update(m,{render:u.sucessMessage,type:c.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),j(!1),C(E=>E+1),p(!1)}).catch(l=>{console.log(l),c.update(m,{render:"Hay problemas de conexión",type:c.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})}).finally(()=>y(!1))},f=a=>a?a.split(" ").map(m=>m?m.charAt(0).toUpperCase()+m.slice(1).toLowerCase():"").join(" "):"";o.useEffect(()=>{for(const a in s){const m=s[a],l=t.hasOwnProperty(a)?t[a]:"";d({type:m,payload:l})}},[t]);const M=async()=>{if(i.dni.length<8)return;let a=await axios.get(`/inquiry/dni?dni=${i.dni}`);a.data.original.hasOwnProperty("nombres")?d({type:s.name,payload:f(a.data.original.nombres)+" "+f(a.data.original.apellidoPaterno)+" "+f(a.data.original.apellidoMaterno)}):c.error("DNI inválido o no encontrando",{autoClose:1500})};return e.jsxs(e.Fragment,{children:[e.jsxs(L,{option:n,open:b,setOpen:p,isLoading:_,handleSubmit:S,icon:$,text:"Usuario",children:[e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-700 placeholder:text-gray-700 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:i.name,onChange:a=>{d({type:s.name,payload:a.target.value})},required:!0,autoFocus:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-700 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Nombre"})]}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-2",children:[e.jsxs("select",{className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-700 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:i.rol_id,onChange:a=>{d({type:s.rol_id,payload:a.target.value})},required:!0,children:[e.jsx("option",{value:"1",children:"Administrador"}),e.jsx("option",{value:"2",children:"Empleado"})]}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-700 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Rol del usuario"})]}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-700 placeholder:text-gray-700 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:i.email,onChange:a=>{d({type:s.email,payload:a.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-700 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Correo electrónico"})]}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-700 placeholder:text-gray-700 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:i.dni,onChange:a=>{d({type:s.dni,payload:a.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-700 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"DNI"}),e.jsx("div",{className:"absolute top-1 right-2 h-full cursor-pointer",onClick:M,children:e.jsx(P,{icon:J,css:"transition-all text-black hover:scale-125",size:"25px"})})]}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-700 placeholder:text-gray-700 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:i.phone,onChange:a=>{d({type:s.phone,payload:a.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-700 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Teléfono"})]}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-700 placeholder:text-gray-700 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:i.direction,onChange:a=>{d({type:s.direction,payload:a.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-700 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Dirección"})]}),n!="Actualizar"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-2",children:[e.jsx("input",{type:x?"text":"password",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-700 placeholder:text-gray-700 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:i.password,onChange:a=>{d({type:s.password,payload:a.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-700 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Contraseña"}),e.jsx("div",{className:"absolute top-1 right-2 hover:scale-125 cursor-pointer transition-all",onClick:()=>N(a=>!a),children:e.jsx(P,{icon:x?Y:U,size:"25px",css:"text-gray-600"})})]}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-2",children:[e.jsx("input",{type:v?"text":"password",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-700 placeholder:text-gray-700 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:i.password_confirmation,onChange:a=>{d({type:s.password_confirmation,payload:a.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-700 peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Repetir contraseña"}),e.jsx("div",{className:"absolute top-1 right-2 hover:scale-125 cursor-pointer transition-all",onClick:()=>g(a=>!a),children:e.jsx(P,{icon:v?Y:U,size:"25px",css:"text-gray-600"})})]})]})]}),e.jsx(L.ToastifyModal,{})]})}function ce({userI:t,setUser:n,setOption:b,setOpenModal:p,setHelper:j,setMustLoad:C,setMustAnimate:x,setIsDeleted:N}){const v=()=>{ne("¿Quieres eliminar este usuario?",()=>{N(!0),x(!1);const g=c(e.jsx(B,{message:`Eliminando a ${t.name}`}),{autoClose:3e3,hideProgressBar:!0});z("DELETE","/users/destroy",{id:t.id}).then(u=>{if(C(!1),u.errors)return N(!1),c.update(g,{render:e.jsx(e.Fragment,{children:e.jsx(q,{data:u.errors})}),type:c.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});c.update(g,{render:`Usuario ${t.name} ha sido eliminado.`,type:c.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),j(i=>i+1)}).catch(u=>{c.update(g,{render:"Hay problemas de conexión",type:c.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})})})};return e.jsxs("div",{className:"px-8 pt-5 flex flex-col justify-between flex-1",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"uppercase tracking-wide text-sm text-indigo-500 font-semibold",children:["Nombre: ",t.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Rol: ",t.rol.name]}),e.jsxs("p",{className:"mt-2 text-gray-700",children:["Correo: ",t.email]}),e.jsxs("p",{className:"text-gray-700",children:["DNI: ",t.dni]}),e.jsxs("p",{className:"text-gray-700",children:["Teléfono: ",t.phone]}),e.jsxs("p",{className:"text-gray-700",children:["Dirección: ",t.direction]}),e.jsxs("p",{className:"text-gray-700",children:["Fecha: ",te(t.created_at)]})]}),e.jsxs("div",{className:"my-3 flex gap-2 pb-4",children:[e.jsx("button",{className:"bg-vetsky rounded-md py-1 px-4 font-semibold hover:bg-gray-400",onClick:()=>{b("Actualizar"),p(!0),n(t)},children:"Editar"}),e.jsx("button",{className:"bg-vetbrown rounded-md py-1 px-4 text-white font-semibold hover:bg-gray-500",onClick:v,children:"Eliminar"})]}),e.jsxs("p",{className:"text-gray-600 font-medium text-sm absolute bottom-1 right-6",children:["Agregado ",re(t.created_at)]})]})}function pe(){var k,A,I;const t={id:"",name:"",email:"",rol_id:2,dni:"",phone:"",direction:"",password:"",password_confirmation:""},n=[{name:"Nombre",value:"name"},{name:"Correo",value:"email"},{name:"DNI",value:"dni"},{name:"Teléfono",value:"phone"}],[b,p]=o.useState(1),[j,C]=o.useState(12),[x,N]=o.useState("name"),[v,g]=o.useState(""),[u,i]=o.useState(""),[d,_]=o.useState(""),[y,S]=o.useState(""),{debounceValue:f}=se(v,500),[M,a]=o.useState(0),m=`/users/list?page=${b}&limit=${j}&filter=${x}&inputFilter=${f}&rol=${u}&startDate=${d}&finishDate=${y}`,{data:l,loading:E}=oe(m,[b,j,M]),[H,R]=o.useState("Crear"),[W,O]=o.useState(!1),[G,T]=o.useState(t),[Q,D]=o.useState(!0),[V,F]=o.useState(!0);return o.useEffect(()=>{E||(D(!0),F(!0),p(1),a(r=>r+1))},[f]),e.jsxs(e.Fragment,{children:[e.jsx(X,{icon:$,message:"Gestión de usuarios",name:"usuario",setOpen:O,setOption:R,setData:T,initialState:t}),e.jsx(ae,{children:n.map((r,h)=>e.jsx("button",{className:`${x===r.value?"bg-vetgreen-200 text-white":"bg-vetgreen-100 hover:bg-vetgreen-200 hover:text-white"} cursor-pointer py-2 md:mx-2 mx-1 rounded-full flex-grow`,onClick:()=>{N(r.value),g("")},children:r.name},h))}),e.jsxs(w,{children:[e.jsxs(w.Search,{inputFilter:v,setInputFilter:g,handleReset:()=>{i(""),_(""),S(""),p(1),a(r=>r+1)},filter:x,filters:n,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Rol de usuario"}),e.jsxs("select",{className:"p-2 rounded-xl bg-gray-300 w-full",value:u,onChange:r=>{i(r.target.value),p(1),a(h=>h+1)},children:[e.jsx("option",{value:"",children:"Cualquiera"}),e.jsx("option",{value:"1",children:"Administrador"}),e.jsx("option",{value:"2",children:"Empleado"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de inicio"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:d,onChange:r=>{_(r.target.value),p(1),a(h=>h+1)}})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de finalización"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:y,onChange:r=>{S(r.target.value),p(1),a(h=>h+1)}})]})]}),e.jsx(w.FilterBar,{hide:!f&&!u&&!d&&!y,data:[{tag:(k=n.find(r=>r.value===x))==null?void 0:k.name,input:f,handleClick:()=>g("")},{tag:"rol",input:u.length>0?u==1?"Administrador":"Empleado":null,handleClick:()=>{i(""),p(1),a(r=>r+1)}},{tag:"Fecha de inicio",input:d.length>0?d:null,handleClick:()=>{_(""),p(1),a(r=>r+1)}},{tag:"Fecha de finalización",input:y.length>0?y:null,handleClick:()=>{S(""),p(1),a(r=>r+1)}}]}),e.jsx(w.CardContainer,{children:E&Q?e.jsx(le,{message:"Cargando usuarios"}):((A=l.data)==null?void 0:A.length)===0?e.jsx("div",{className:"bg-white p-4 border rounded shadow-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-lg",children:[e.jsx(P,{icon:Z,css:"mr-3"}),"No hay datos disponibles."]})}):e.jsx(e.Fragment,{children:(I=l==null?void 0:l.data)==null?void 0:I.map((r,h)=>e.jsx(w.CardContainer.Card,{mustAnimate:V,setMustAnimate:F,children:e.jsx(ce,{userI:r,setUser:T,setOption:R,setOpenModal:O,setHelper:a,setMustLoad:D,setMustAnimate:F})},`${r.id}-${h}`))})}),e.jsx(w.Pagination,{pageQuantity:l.current_page*l.per_page,quantity:l.total,setMustLoad:D,setLimit:C,setPage:p,nextPage:l.next_page_url,prevPage:l.prev_page_url,page:l.current_page,lastPage:l.last_page,setMustAnimate:F})]}),e.jsx(de,{user:G,option:H,open:W,setOpen:O,setMustLoad:D,setHelper:a}),e.jsx(ee,{})]})}const ue=K.createRoot(document.getElementById("user"));ue.render(e.jsx(pe,{}));
