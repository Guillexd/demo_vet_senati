import{j as e,I as F,d as Y,r as s,H as Q,g as W,e as G,F as q}from"./Footer-5b55d698.js";import{F as U}from"./Filters-74b6bb7b.js";import{c as V,d as J,s as K,Q as o,S as X,f as Z,T as I,u as ee,a as te,b as f,L as ae}from"./Spinner-fd53bf80.js";import{f as B}from"./index-7c0738bf.js";import{C as se,i as ne}from"./initialStateCustomer-6990e1eb.js";function ie({customerI:t,setCustomer:j,setOption:b,setOpenModal:r,setHelper:y,setMustLoad:_,setMustAnimate:p,setIsDeleted:u}){var x,d,h;const v=()=>{K("¿Quieres eliminar este cliente?",()=>{u(!0),p(!1);const i=o(e.jsx(X,{message:`Eliminando a ${t.name}`}),{autoClose:3e3,hideProgressBar:!0});Z("DELETE","/customers/destroy",{id:t.id}).then(l=>{if(_(!1),l.errors)return u(!1),o.update(i,{render:e.jsx(e.Fragment,{children:e.jsx(I,{data:l.errors})}),type:o.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});if(l.message)return u(!1),o.update(i,{render:e.jsx(e.Fragment,{children:l.message}),type:o.TYPE.INFO,autoClose:3e3,hideProgressBar:!1});o.update(i,{render:`Cliente ${t.name} ha sido eliminado.`,type:o.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),y(g=>g+1)}).catch(l=>{u(!1),o.update(i,{render:"Hay problemas de conexión",type:o.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})})},"Se eliminarán los datos asociados a este cliente como sus mascotas y el historial de las mismas.")};return e.jsxs("div",{className:"px-8 pt-5 flex flex-col justify-between flex-1",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"uppercase tracking-wide text-sm text-indigo-500 font-semibold",children:["Nombre: ",t.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Tipo de documento: ",(x=t.identity_document)!=null&&x.description?`${(d=t.identity_document)==null?void 0:d.description} (${(h=t.identity_document)==null?void 0:h.abbreviation})`:"---"]}),e.jsxs("p",{className:"text-gray-900 font-semibold",children:["Documento de identidad: ",t.document_number||"---"]}),t.first_phone?e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-gray-700",children:["1º teléfono:",e.jsxs("a",{href:`https://api.whatsapp.com/send/?phone=${t.first_phone}&text=Hola,%20¿cómo%20estás%20${t.name}?&type=phone_number&app_absent=0`,target:"_blank",className:"font-bold bg-emerald-300 p-1 rounded-md hover:bg-green-400",children:[e.jsx(F,{icon:B,css:"mr-1",size:"22px"}),t.first_phone]})]})}):e.jsx("p",{className:"mt-2 text-gray-700",children:"1º teléfono: ---"}),t.second_phone?e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-gray-700",children:["2º teléfono:",e.jsxs("a",{href:`https://api.whatsapp.com/send/?phone=${t.second_phone}&text=Hola,%20¿cómo%20estás%20${t.name}?&type=phone_number&app_absent=0`,target:"_blank",className:"font-bold bg-emerald-300 p-1 rounded-md hover:bg-green-400",children:[e.jsx(F,{icon:B,css:"mr-1",size:"22px"}),t.second_phone]})]})}):e.jsx("p",{className:"text-gray-700",children:"2º teléfono: ---"}),e.jsxs("p",{className:"text-gray-700",children:["Dirección: ",t.direction||"---"]}),e.jsxs("p",{className:"text-gray-700",children:["Fecha: ",V(t.created_at)]})]}),e.jsxs("div",{className:"my-3 flex gap-2 pb-4",children:[e.jsx("button",{className:"bg-vetsky rounded-md py-1 px-4 font-semibold hover:bg-gray-400",onClick:()=>{b("Actualizar"),r(!0),j(t)},children:"Editar"}),e.jsx("button",{className:"bg-vetbrown rounded-md py-1 px-4 text-white font-semibold hover:bg-gray-500",onClick:v,children:"Eliminar"})]}),e.jsxs("p",{className:"text-gray-600 font-medium text-sm absolute bottom-1 right-6",children:["Agregado ",J(t.created_at)]})]})}function re(){var P,D,T;const t={...ne},j=[{name:"Nombre",value:"name"},{name:"Documento de identidad",value:"document_number"},{name:"1° teléfono",value:"first_phone"},{name:"2° teléfono",value:"second_phone"}],[b,r]=s.useState(1),[y,_]=s.useState(12),[p,u]=s.useState("name"),[v,x]=s.useState(""),[d,h]=s.useState(""),[i,l]=s.useState(""),{debounceValue:g}=ee(v,500),[L,c]=s.useState(0),R=`/customers/list?page=${b}&limit=${y}&filter=${p}&inputFilter=${g}&startDate=${d}&finishDate=${i}`,{data:n,loading:w}=te(R,[b,y,L]),[H,E]=s.useState("Crear"),[z,S]=s.useState(!1),[A,$]=s.useState(t),[O,N]=s.useState(!0),[M,C]=s.useState(!0);return s.useEffect(()=>{w||(N(!0),C(!0),r(1),c(a=>a+1))},[g]),e.jsxs(e.Fragment,{children:[e.jsx(Q,{icon:W,message:"Gestión de clientes",name:"cliente",setOpen:S,setOption:E,setData:$,initialState:t}),e.jsx(U,{children:e.jsx("div",{className:"w-full flex justify-between flex-wrap sm:flex-nowrap gap-y-1",children:j.map((a,m)=>e.jsx("button",{className:`${p===a.value?"bg-vetgreen-200 text-white":"bg-vetgreen-100 hover:bg-vetgreen-200 hover:text-white"} min-w-20 cursor-pointer py-2 md:mx-2 mx-1 rounded-xl sm:rounded-full flex-grow`,onClick:()=>{var k;u(a.value),x(""),(k=document.getElementById("input_search"))==null||k.focus()},children:a.name},m))})}),e.jsxs(f,{children:[e.jsxs(f.Search,{inputFilter:v,setInputFilter:x,handleReset:()=>{h(""),l(""),r(1),c(a=>a+1)},filter:p,filters:j,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de inicio"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:d,onChange:a=>{h(a.target.value),r(1),c(m=>m+1)}})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm my-2",children:"Fecha de finalización"}),e.jsx("input",{type:"date",className:"p-2 rounded-xl bg-gray-300 w-full",value:i,onChange:a=>{l(a.target.value),r(1),c(m=>m+1)}})]})]}),e.jsx(f.FilterBar,{hide:!g&&!d&&!i,data:[{tag:(P=j.find(a=>a.value===p))==null?void 0:P.name,input:g,handleClick:()=>x("")},{tag:"Fecha de inicio",input:d.length>0?d:null,handleClick:()=>{h(""),r(1),c(a=>a+1)}},{tag:"Fecha de finalización",input:i.length>0?i:null,handleClick:()=>{l(""),r(1),c(a=>a+1)}}]}),e.jsx(f.CardContainer,{children:w&O?e.jsx(ae,{message:"Cargando clientes"}):((D=n.data)==null?void 0:D.length)===0?e.jsx("div",{className:"bg-white p-4 border rounded shadow-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-lg",children:[e.jsx(F,{icon:G,css:"mr-3"}),"No hay datos disponibles."]})}):e.jsx(e.Fragment,{children:(T=n==null?void 0:n.data)==null?void 0:T.map((a,m)=>e.jsx(f.CardContainer.Card,{mustAnimate:M,setMustAnimate:C,children:e.jsx(ie,{customerI:a,setCustomer:$,setOption:E,setOpenModal:S,setHelper:c,setMustLoad:N,setMustAnimate:C})},`${a.id}-${m}`))})}),e.jsx(f.Pagination,{pageQuantity:n.current_page*n.per_page,quantity:n.total,setMustLoad:N,setLimit:_,setPage:r,nextPage:n.next_page_url,prevPage:n.prev_page_url,page:n.current_page,lastPage:n.last_page,setMustAnimate:C})]}),e.jsx(se,{customer:A,option:H,open:z,setOpen:S,setMustLoad:N,setHelper:c}),e.jsx(q,{})]})}const le=Y.createRoot(document.getElementById("customer"));le.render(e.jsx(re,{}));
