import{j as e,r,k as w,d as q,l as Q,D as W,I as V,e as J,F as K}from"./Footer-1433491c.js";import{F as X}from"./Filters-7240b55f.js";import{e as Z,s as ee,Q as o,S as O,f as Y,T as k,M as R,u as te,a as ae,b as j,L as re}from"./Spinner-b109c97d.js";import{B as se,I as ne}from"./ImportExcelModal-7121b9bf.js";function oe({serviceI:t,setService:s,setOption:y,setOpenModal:p,setHelper:g,setMustLoad:v,setMustAnimate:l,rol:m,setIsDeleted:c}){const x=()=>{ee("¿Quieres eliminar este servicio?",()=>{c(!0),l(!1);const i=o(e.jsx(O,{message:`Eliminando a ${t.name}`}),{autoClose:3e3,hideProgressBar:!0});Y("DELETE","/services/destroy",{id:t.id}).then(u=>{if(v(!1),u.errors)return c(!1),o.update(i,{render:e.jsx(e.Fragment,{children:e.jsx(k,{data:u.errors})}),type:o.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});if(u.message)return c(!1),o.update(i,{render:e.jsx(e.Fragment,{children:u.message}),type:o.TYPE.INFO,autoClose:3e3,hideProgressBar:!1});o.update(i,{render:`Servicio ${t.name} ha sido eliminado.`,type:o.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),g(n=>n+1)}).catch(u=>{c(!1),o.update(i,{render:"Hay problemas de conexión",type:o.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})})})};return e.jsx("section",{className:`${!t.isActive&&"bg-gray-300"}`,children:e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row my-3 p-2 md:p-0 md:px-5",children:[m==1&&e.jsx(se,{isActive:t.isActive,id:t.id,name:t.name,model:"services",setHelper:g,setMustLoad:v,css:"bottom-2 right-2"}),e.jsxs("p",{className:"uppercase tracking-wide text-sm text-indigo-500 font-semibold text-center md:text-start md:w-5/12 m-auto",children:["Nombre: ",t.name]}),e.jsxs("p",{className:"text-gray-900 font-semibold text-center m-auto",children:["Código: ",Z("S",t.id)]}),e.jsxs("p",{className:"text-gray-900 font-semibold text-center m-auto",children:["Precio: S/",t.price]}),m==1&&e.jsxs("div",{className:"flex justify-center items-center gap-2 lg:me-10",children:[e.jsx("button",{className:"bg-vetsky rounded-md py-1 px-4 font-semibold hover:bg-gray-400",onClick:()=>{y("Actualizar"),p(!0),s(t)},children:"Editar"}),e.jsx("button",{className:"bg-vetbrown rounded-md py-1 px-4 text-white font-semibold hover:bg-gray-500",onClick:x,children:"Eliminar"})]})]})})}const f={id:"MODIFY_ID",name:"MODIFY_NAME",price:"MODIFY_PRICE"};function ie(t,s){switch(s.type){case f.id:return{...t,id:s.payload};case f.name:return{...t,name:s.payload};case f.price:return{...t,price:s.payload};default:return t}}function le({service:t,option:s,open:y,setOpen:p,setMustLoad:g,setHelper:v}){const l={method:s==="Crear"?"POST":"PUT",url:s!=="Actualizar"?"/services/store":"/services/update",sucessMessage:s==="Crear"?"Servicio agregado":"Servicio actualizado",loadingMessage:s!=="Actualizar"?"Agregando servicio":"Actualizando servicio"},[m,c]=r.useReducer(ie,t),[x,i]=r.useState(!1),u=n=>{n.preventDefault(),i(!0);const h=o(e.jsx(O,{message:l.loadingMessage}),{autoClose:1e4,hideProgressBar:!0});Y(l.method,l.url,m).then(a=>{if(a.errors)return o.update(h,{render:e.jsx(e.Fragment,{children:e.jsx(k,{data:a.errors})}),type:o.TYPE.ERROR,autoClose:3e3,hideProgressBar:!1});o.update(h,{render:l.sucessMessage,type:o.TYPE.SUCCESS,autoClose:1500,hideProgressBar:!1}),g(!1),v(S=>S+1),p(!1)}).catch(a=>{console.log(a),o.update(h,{render:"Hay problemas de conexión",type:o.TYPE.WARNING,autoClose:2500,hideProgressBar:!1})}).finally(()=>i(!1))};return r.useEffect(()=>{for(const n in f){const h=f[n],a=t.hasOwnProperty(n)?t[n]:"";c({type:h,payload:a})}},[t]),e.jsxs(e.Fragment,{children:[e.jsxs(R,{option:s,open:y,setOpen:p,isLoading:x,handleSubmit:u,icon:w,text:"Servicio",children:[e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:m.name,onChange:n=>{c({type:f.name,payload:n.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Nombre"})]}),e.jsxs("div",{className:"relative border border-gray-600 rounded w-full order-1",children:[e.jsx("input",{type:"text",className:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none text-gray-600  placeholder:text-gray-600  [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0",value:m.price,onChange:n=>{c({type:f.price,payload:n.target.value})},required:!0}),e.jsx("label",{className:"pointer-events-none absolute left-3 top-0 mb-0 max-w-[90%] origin-[0_0] truncate pt-[0.37rem] leading-[1.6] transition-all duration-200 ease-out peer-focus:-translate-y-[1.8rem] peer-focus:scale-[0.9] peer-data-[te-input-state-active]:-translate-y-[2rem] peer-data-[te-input-state-active]:scale-[0.9] motion-reduce:transition-none text-gray-600  peer-focus:text-primary peer-valid:-translate-y-[1.8rem] peer-valid:scale-[0.9] peer-valid:text-primary",children:"Precio"})]})]}),e.jsx(R.ToastifyModal,{})]})}function ce(){var M,A,B;const t={id:"",name:"",price:""},s=[{name:"Nombre",value:"name"},{name:"Código",value:"id"}],[y,p]=r.useState(1),[g,v]=r.useState(12),[l,m]=r.useState("name"),[c,x]=r.useState(""),{debounceValue:i}=te(c),[u,n]=r.useState(0),h=`/services/list?page=${y}&limit=${g}&filter=${l}&inputFilter=${i}`,{data:a,loading:S}=ae(h,[y,g,u]),[$,F]=r.useState("Crear"),[I,N]=r.useState(!1),[L,T]=r.useState(t),[z,C]=r.useState(!0),[H,E]=r.useState(!0),[G,P]=r.useState(!1);r.useEffect(()=>{S||(C(!0),E(!0),p(1),n(d=>d+1))},[i]);const[_,U]=r.useState(2);return r.useEffect(()=>{const b=document.getElementById("service").getAttribute("role");U(b)},[]),e.jsxs(e.Fragment,{children:[_==1?e.jsx(Q,{icon:w,message:"Gestión de servicios",name:"servicio",setOpen:N,setOption:F,setData:T,initialState:t,setOpenImport:P}):e.jsx(W,{icon:w,message:"Gestión de servicios",setOpenImport:P}),e.jsx(X,{children:s.map((d,b)=>e.jsx("button",{className:`${l===d.value?"bg-vetgreen-200 text-white":"bg-vetgreen-100 hover:bg-vetgreen-200 hover:text-white"} cursor-pointer py-2 md:mx-2 mx-1 rounded-full flex-grow`,onClick:()=>{var D;m(d.value),x(""),(D=document.getElementById("input_search"))==null||D.focus()},children:d.name},b))}),e.jsxs(j,{children:[e.jsx(j.Search,{inputFilter:c,setInputFilter:x,filter:l,filters:s,renderMoreFilters:!1}),e.jsx(j.FilterBar,{hide:!i,data:[{tag:(M=s.find(d=>d.value===l))==null?void 0:M.name,input:i,handleClick:()=>x("")}]}),e.jsx(j.CardContainer,{children:S&z?e.jsx(re,{message:"Cargando servicios"}):((A=a.data)==null?void 0:A.length)===0?e.jsx("div",{className:"bg-white p-4 border rounded shadow-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-lg",children:[e.jsx(V,{icon:J,css:"mr-3"}),"No hay datos disponibles."]})}):e.jsx(e.Fragment,{children:(B=a==null?void 0:a.data)==null?void 0:B.map((d,b)=>e.jsx(j.CardContainer.Card,{mustAnimate:H,setMustAnimate:E,width:"w-full",children:e.jsx(oe,{serviceI:d,setService:T,setOption:F,setOpenModal:N,setHelper:n,setMustLoad:C,setMustAnimate:E,rol:_})},`${d.id}-${b}`))})}),e.jsx(j.Pagination,{pageQuantity:a.current_page*a.per_page,quantity:a.total,setMustLoad:C,setLimit:v,setPage:p,nextPage:a.next_page_url,prevPage:a.prev_page_url,page:a.current_page,lastPage:a.last_page,setMustAnimate:E})]}),e.jsx(le,{service:L,option:$,open:I,setOpen:N,setMustLoad:C,setHelper:n}),e.jsx(ne,{open:G,setOpen:P,url:"/services/import",format:"formato_servicios.xlsx",setPage:p,setHelper:n}),e.jsx(K,{})]})}const de=q.createRoot(document.getElementById("service"));de.render(e.jsx(ce,{}));
